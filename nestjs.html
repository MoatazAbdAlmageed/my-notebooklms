<!DOCTYPE html>
<html lang="ar">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>NestJS</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="dark.css">
</head>
<body>
    <h2 id="-nestjs-">🔷 ما هو NestJS ؟</h2>
    <p><strong>NestJS</strong> هو <strong>فريمورك لتطوير تطبيقات السيرفر (Backend Applications)</strong> مبني فوق <strong>Node.js</strong> ويستخدم <strong>TypeScript</strong> بشكل كامل.</p>
    <p>هو بيعتبر نفسه <strong>الـ Laravel بتاع Node.js</strong> — بيقدملك تنظيم وهيكل للكود، modular architecture، dependency injection، decorators، وكل المفاهيم اللي بتخلي الكود نظيف وسهل التوسّع.</p>
    <hr>
    <h2 id="-nestjs-express-">🔷 ليه NestJS مش Express بس؟</h2>
    <blockquote>
    <p>Express هو مكتبة خفيفة، بينما NestJS فريمورك متكامل فوق Express.</p>
    </blockquote>
    <p>NestJS فعلياً بيستخدم Express (أو Fastify) تحت الغطاء، لكنه بيضيف فوقه:</p>
    <ul>
    <li><strong>Modules System</strong> لتنظيم المشروع.</li>
    <li><strong>Dependency Injection Container</strong> زي اللي في Laravel (Service Container).</li>
    <li><strong>Decorators</strong> للتعامل مع الـ routes والـ validation بطريقة أنيقة.</li>
    <li><strong>Guards / Pipes / Interceptors</strong> لتنفيذ منطق مشترك زي auth أو transformation.</li>
    <li><strong>Support for GraphQL, WebSockets, Microservices</strong>.</li>
    </ul>
    <hr>
    <h2 id="-architecture-">🔷 المعمارية (Architecture)</h2>
    <p>المشروع في NestJS بيكون مبني على مبدأ الـ <strong>Modular Architecture</strong>:</p>
    <pre><code>src/
     ├── app<span class="hljs-selector-class">.module</span><span class="hljs-selector-class">.ts</span>        <span class="hljs-comment">// الموديول الرئيسي</span>
     ├── users/
     │     ├── users<span class="hljs-selector-class">.module</span><span class="hljs-selector-class">.ts</span>
     │     ├── users<span class="hljs-selector-class">.controller</span><span class="hljs-selector-class">.ts</span>
     │     └── users<span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.ts</span>
     └── main<span class="hljs-selector-class">.ts</span>               <span class="hljs-comment">// نقطة الدخول (bootstrap)</span>
    </code></pre><p>كل <strong>Module</strong> بيحتوي على:</p>
    <ul>
    <li><strong>Controller</strong>: مسؤول عن استقبال الطلبات (زي الـ Controller في Laravel).</li>
    <li><strong>Service (Provider)</strong>: يحتوي على الـ Business Logic.</li>
    <li><strong>Module</strong>: بيلم الاتنين مع بعض ويُصدّرهم.</li>
    </ul>
    <hr>
    <h2 id="-flow-nestjs">🔷 الـ Flow داخل NestJS</h2>
    <ol>
    <li>المستخدم يعمل request.</li>
    <li>الـ <strong>Controller</strong> يستقبل الطلب.</li>
    <li>الـ <strong>Controller</strong> يستدعي <strong>Service</strong> علشان ينفّذ المنطق.</li>
    <li>الـ <strong>Service</strong> ممكن يتعامل مع الـ Database أو أي مزود آخر.</li>
    <li>النتيجة ترجع للـ Controller، ومنها للـ Response.</li>
    </ol>
    <p>📘 نفس فكرة Laravel:
    <code>Route → Controller → Service (Business Logic) → Model → Response</code></p>
    <hr>
    <h2 id="-nestjs">🔷 أهم المفاهيم في NestJS</h2>
    <table>
    <thead>
    <tr>
    <th>المفهوم</th>
    <th>المعنى</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td><strong>Module</strong></td>
    <td>جزء من التطبيق يحتوي على controllers, providers.</td>
    </tr>
    <tr>
    <td><strong>Controller</strong></td>
    <td>يتعامل مع الـ HTTP requests/responses.</td>
    </tr>
    <tr>
    <td><strong>Provider / Service</strong></td>
    <td>يحتوي الـ logic الحقيقي. يتم حقنه عبر DI.</td>
    </tr>
    <tr>
    <td><strong>Decorator</strong></td>
    <td>Syntax زي <code>@Controller()</code>, <code>@Get()</code>, <code>@Injectable()</code> لتحديد السلوك.</td>
    </tr>
    <tr>
    <td><strong>Pipe</strong></td>
    <td>لمعالجة وتحويل البيانات (validation, transformation).</td>
    </tr>
    <tr>
    <td><strong>Guard</strong></td>
    <td>للتحكم في الوصول (authorization).</td>
    </tr>
    <tr>
    <td><strong>Interceptor</strong></td>
    <td>لاعتراض الطلبات/الردود (logging, caching...).</td>
    </tr>
    <tr>
    <td><strong>Middleware</strong></td>
    <td>كود بيتنفّذ قبل الوصول للـ route (زي Laravel middleware).</td>
    </tr>
    </tbody>
    </table>
    <hr>
    <h2 id="-">🔷 مثال بسيط</h2>
    <pre><code class="lang-ts"><span class="hljs-comment">// users.controller.ts</span>
    <span class="hljs-keyword">import</span> { Controller, Get } from <span class="hljs-string">'@nestjs/common'</span>;
    <span class="hljs-keyword">import</span> { UsersService } from <span class="hljs-string">'./users.service'</span>;
    
    <span class="hljs-meta">@Controller(<span class="hljs-meta-string">'users'</span>)</span>
    export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> </span>{
      <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">private</span> usersService: UsersService) {}
    
      <span class="hljs-meta">@Get()</span>
      getAllUsers() {
        <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.usersService.findAll();
      }
    }
    
    <span class="hljs-comment">// users.service.ts</span>
    <span class="hljs-keyword">import</span> { Injectable } from <span class="hljs-string">'@nestjs/common'</span>;
    
    <span class="hljs-meta">@Injectable()</span>
    export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersService</span> </span>{
      findAll() {
        <span class="hljs-keyword">return</span> [<span class="hljs-string">'Ali'</span>, <span class="hljs-string">'Sara'</span>, <span class="hljs-string">'Omar'</span>];
      }
    }
    
    <span class="hljs-comment">// users.module.ts</span>
    <span class="hljs-keyword">import</span> { Module } from <span class="hljs-string">'@nestjs/common'</span>;
    <span class="hljs-keyword">import</span> { UsersController } from <span class="hljs-string">'./users.controller'</span>;
    <span class="hljs-keyword">import</span> { UsersService } from <span class="hljs-string">'./users.service'</span>;
    
    <span class="hljs-meta">@Module({
      controllers: [UsersController],
      providers: [UsersService],
    })</span>
    export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersModule</span> </span>{}
    </code></pre>
    <hr>
    <h2 id="-nestjs-">🔷 مميزات NestJS في الانترفيو</h2>
    <p>لو سُئلت: <strong>&quot;ليه تستخدم NestJS بدل Express أو Laravel؟&quot;</strong>
    جاوب كده:</p>
    <blockquote>
    <p>NestJS بيوفر تنظيم قوي للكود على مستوى enterprise apps، باستخدام TypeScript وDependency Injection، وبيسهّل بناء RESTful APIs أو Microservices بشكل قابل للتوسّع وسهل الصيانة، وكمان بيتكامل مع كل أدوات Node ecosystem زي Prisma, TypeORM, Mongoose، إلخ.</p>
    </blockquote>
    <hr>
    <h2 id="-laravel-">🔷 مقارنة سريعة مع Laravel (مهمة في الانترفيو)</h2>
    <table>
    <thead>
    <tr>
    <th>المفهوم</th>
    <th>Laravel</th>
    <th>NestJS</th>
    </tr>
    </thead>
    <tbody>
    <tr>
    <td>اللغة</td>
    <td>PHP</td>
    <td>TypeScript (Node.js)</td>
    </tr>
    <tr>
    <td>Dependency Injection</td>
    <td>Service Container</td>
    <td>DI Container</td>
    </tr>
    <tr>
    <td>Routes</td>
    <td>web.php / api.php</td>
    <td>Decorators مثل @Get(), @Post()</td>
    </tr>
    <tr>
    <td>Middleware</td>
    <td>Kernel</td>
    <td>Middleware</td>
    </tr>
    <tr>
    <td>Service Providers</td>
    <td>Providers</td>
    <td>Providers</td>
    </tr>
    <tr>
    <td>Modules / Packages</td>
    <td>Service Providers</td>
    <td>Modules</td>
    </tr>
    <tr>
    <td>ORM</td>
    <td>Eloquent</td>
    <td>TypeORM / Prisma / Mongoose</td>
    </tr>
    <tr>
    <td>CLI Tool</td>
    <td>Artisan</td>
    <td>Nest CLI</td>
    </tr>
    </tbody>
    </table>
    <hr>
    <p>لو حابب، أقدر أجهزلك إجابة جاهزة بصيغة <strong>&quot;جواب مقابلة عمل&quot;</strong> فيها نبرة احترافية وسريعة (زي 1 دقيقة كلام).
    تحب أعملها لك كده؟</p>


    <p>أكيد 👌
      فيما يلي <strong>قائمة شاملة لجميع مواضيع NestJS</strong> — مرتبة من الأساسيات إلى المفاهيم المتقدمة — بحيث يمكنك استخدامها كـ roadmap أو checklist للتحضير لأي مقابلة أو لتعلّم الفريمورك بعمق.</p>
      <hr>
      <h2 id="-fundamentals-">🧩 <strong>المستوى الأول: الأساسيات (Fundamentals)</strong></h2>
      <ol>
      <li><p><strong>ما هو NestJS؟</strong></p>
      <ul>
      <li>تعريف، المميزات، ولماذا يستخدم فوق Express أو Fastify.</li>
      </ul>
      </li>
      <li><p><strong>التثبيت والتهيئة (Installation &amp; Setup)</strong></p>
      <ul>
      <li>Nest CLI</li>
      <li>Project structure</li>
      <li>main.ts و bootstrap function</li>
      </ul>
      </li>
      <li><p><strong>Modules (الموديولات)</strong></p>
      <ul>
      <li>المفهوم والدور</li>
      <li><code>@Module()</code> decorator</li>
      <li>imports / exports / providers / controllers</li>
      <li>الـ root module (AppModule)</li>
      </ul>
      </li>
      <li><p><strong>Controllers (التحكم بالـ Routes)</strong></p>
      <ul>
      <li><code>@Controller()</code> decorator</li>
      <li><code>@Get()</code>, <code>@Post()</code>, <code>@Put()</code>, <code>@Delete()</code></li>
      <li>Route parameters &amp; query params</li>
      <li>Request &amp; Response objects</li>
      </ul>
      </li>
      <li><p><strong>Providers &amp; Services (مزودات الخدمات)</strong></p>
      <ul>
      <li><code>@Injectable()</code> decorator</li>
      <li>Dependency Injection</li>
      <li>Singleton pattern in NestJS</li>
      <li>Service layer structure</li>
      </ul>
      </li>
      <li><p><strong>Dependency Injection Container (DI Container)</strong></p>
      <ul>
      <li>مفاهيم الحقن</li>
      <li>استخدام <code>@Inject()</code></li>
      <li>Custom providers</li>
      <li>useClass, useExisting, useFactory, useValue</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-core-concepts-">⚙️ <strong>المستوى الثاني: الأدوات الأساسية (Core Concepts)</strong></h2>
      <ol>
      <li><p><strong>Pipes (الأنابيب)</strong></p>
      <ul>
      <li>Built-in pipes (<code>ValidationPipe</code>, <code>ParseIntPipe</code>, إلخ)</li>
      <li>Custom pipes</li>
      <li>Data transformation &amp; validation</li>
      </ul>
      </li>
      <li><p><strong>Guards (الحراس)</strong></p>
      <ul>
      <li><code>@UseGuards()</code></li>
      <li>Authorization &amp; role-based access control (RBAC)</li>
      <li>Custom guards</li>
      </ul>
      </li>
      <li><p><strong>Interceptors (المعترضات)</strong></p>
      <ul>
      <li>Logging, transformation, caching</li>
      <li><code>@UseInterceptors()</code> decorator</li>
      <li><code>CallHandler</code> and <code>next.handle()</code> flow</li>
      </ul>
      </li>
      <li><p><strong>Filters (فلاتر الاستثناءات)</strong></p>
      <ul>
      <li>Exception handling</li>
      <li>Built-in HTTP exceptions (<code>HttpException</code>, <code>BadRequestException</code>, إلخ)</li>
      <li>Custom exception filters</li>
      <li><code>@UseFilters()</code> decorator</li>
      </ul>
      </li>
      <li><p><strong>Middleware (الوسيطات)</strong></p>
      <ul>
      <li>Functional &amp; class-based middlewares</li>
      <li><code>app.use()</code></li>
      <li>Difference between middleware, guard, interceptor</li>
      </ul>
      </li>
      <li><p><strong>Routing Techniques</strong></p>
      <ul>
      <li>Nested routing</li>
      <li>Global prefix</li>
      <li>Param decorators: <code>@Param()</code>, <code>@Body()</code>, <code>@Query()</code>, <code>@Headers()</code>, إلخ</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-data-layer-">🗃️ <strong>المستوى الثالث: التعامل مع البيانات (Data Layer)</strong></h2>
      <ol>
      <li><p><strong>Integration with Databases</strong></p>
      <ul>
      <li>TypeORM</li>
      <li>Prisma</li>
      <li>Mongoose (MongoDB)</li>
      <li>Repository pattern</li>
      </ul>
      </li>
      <li><p><strong>Entities &amp; Schemas</strong></p>
      <ul>
      <li>TypeORM entities</li>
      <li>DTOs (Data Transfer Objects)</li>
      <li>Validation with <code>class-validator</code> &amp; <code>class-transformer</code></li>
      </ul>
      </li>
      <li><p><strong>Repositories &amp; Custom Queries</strong></p>
      <ul>
      <li>Injecting repositories</li>
      <li>QueryBuilder</li>
      <li>Relations &amp; eager loading</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-security-auth-">🔐 <strong>المستوى الرابع: الأمان والتوثيق (Security &amp; Auth)</strong></h2>
      <ol>
      <li><p><strong>Authentication &amp; Authorization</strong></p>
      <ul>
      <li>Local strategy</li>
      <li>JWT authentication</li>
      <li>Passport.js integration</li>
      <li>Role-based access control (RBAC)</li>
      </ul>
      </li>
      <li><p><strong>Encryption / Hashing</strong></p>
      <ul>
      <li>Bcrypt for passwords</li>
      <li>Environment variables (dotenv)</li>
      </ul>
      </li>
      <li><p><strong>CORS, CSRF, Rate limiting</strong></p>
      <ul>
      <li>Secure headers (Helmet)</li>
      <li>Throttler module</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-apis-communication-">🌐 <strong>المستوى الخامس: APIs &amp; Communication</strong></h2>
      <ol>
      <li><p><strong>RESTful APIs</strong></p>
      <ul>
      <li>Versioning</li>
      <li>CRUD operations</li>
      <li>Response shaping</li>
      </ul>
      </li>
      <li><p><strong>GraphQL</strong></p>
      <ul>
      <li>Schema-first vs code-first approaches</li>
      <li>Resolvers, Queries, Mutations</li>
      <li>Apollo integration</li>
      </ul>
      </li>
      <li><p><strong>WebSockets (Real-time communication)</strong></p>
      <ul>
      <li>Gateway &amp; <code>@WebSocketGateway()</code></li>
      <li>Events, message handling</li>
      <li>Rooms/channels</li>
      </ul>
      </li>
      <li><p><strong>Microservices</strong></p>
      <ul>
      <li>Transport layers: TCP, Redis, NATS, RabbitMQ, Kafka</li>
      <li>Message patterns (send/emit)</li>
      <li>Context &amp; message brokers</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-advanced-concepts-">⚡ <strong>المستوى السادس: أدوات متقدمة (Advanced Concepts)</strong></h2>
      <ol>
      <li><p><strong>Custom Decorators</strong></p>
      <ul>
      <li>Parameter decorators</li>
      <li>Class &amp; method decorators</li>
      </ul>
      </li>
      <li><p><strong>Lifecycle Events</strong></p>
      <ul>
      <li><code>OnModuleInit</code>, <code>OnApplicationBootstrap</code>, <code>OnModuleDestroy</code></li>
      </ul>
      </li>
      <li><p><strong>Dynamic Modules</strong></p>
      <ul>
      <li>Configurable modules</li>
      <li>forRoot / forFeature patterns</li>
      </ul>
      </li>
      <li><p><strong>Caching</strong></p>
      <ul>
      <li>In-memory cache</li>
      <li>Redis cache module</li>
      </ul>
      </li>
      <li><p><strong>Configuration Management</strong></p>
      <ul>
      <li><code>@nestjs/config</code></li>
      <li><code>.env</code> files</li>
      <li>Environment-based configuration</li>
      </ul>
      </li>
      <li><p><strong>Logging &amp; Monitoring</strong></p>
      <ul>
      <li><code>Logger</code> service</li>
      <li>Global interceptors for logging</li>
      <li>Integration with tools (Winston, Morgan, Sentry)</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-devops-testing-">🧰 <strong>المستوى السابع: DevOps &amp; Testing</strong></h2>
      <ol>
      <li><p><strong>Testing</strong></p>
      <ul>
      <li>Unit testing (Jest)</li>
      <li>Integration testing</li>
      <li>Mocking services and repositories</li>
      </ul>
      </li>
      <li><p><strong>Error Handling &amp; Global Filters</strong></p>
      <ul>
      <li>Global exception filters</li>
      <li>Standardized error responses</li>
      </ul>
      </li>
      <li><p><strong>Deployment &amp; Production Readiness</strong></p>
      <ul>
      <li>Using PM2 or Docker</li>
      <li>Environment configuration</li>
      <li>Performance tuning</li>
      </ul>
      </li>
      <li><p><strong>Swagger (API Documentation)</strong></p>
      <ul>
      <li><code>@nestjs/swagger</code> integration</li>
      <li>Auto-generating docs</li>
      <li>DTOs + decorators for docs</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-patterns-architecture-">🧠 <strong>المستوى الثامن: Patterns &amp; Architecture</strong></h2>
      <ol>
      <li><p><strong>Clean Architecture / DDD with NestJS</strong></p>
      <ul>
      <li>Layers: domain, application, infrastructure</li>
      <li>Dependency inversion</li>
      </ul>
      </li>
      <li><p><strong>Event-based Architecture</strong></p>
      <ul>
      <li>EventEmitter2</li>
      <li>CQRS pattern (Command Query Responsibility Segregation)</li>
      </ul>
      </li>
      <li><p><strong>Monorepo Support</strong></p>
      <ul>
      <li>Nest workspace</li>
      <li>Nx integration</li>
      </ul>
      </li>
      <li><p><strong>Hybrid Applications</strong></p>
      <ul>
      <li>Serving multiple protocols (HTTP + WebSocket + Microservice)</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-integrations-ecosystem-">🚀 <strong>المستوى التاسع: Integrations &amp; Ecosystem</strong></h2>
      <ol>
      <li><p><strong>File Uploads (Multer)</strong></p>
      <ul>
      <li>Single/multiple uploads</li>
      <li>Validation, interceptors</li>
      </ul>
      </li>
      <li><p><strong>Email Sending</strong></p>
      <ul>
      <li>Nodemailer integration</li>
      <li>MailerModule</li>
      </ul>
      </li>
      <li><p><strong>Task Scheduling</strong></p>
      <ul>
      <li><code>@nestjs/schedule</code></li>
      <li>Cron jobs</li>
      </ul>
      </li>
      <li><p><strong>Queues</strong></p>
      <ul>
      <li><code>@nestjs/bull</code> (BullMQ)</li>
      <li>Background jobs and workers</li>
      </ul>
      </li>
      </ol>
      <hr>
      <h2 id="-">🧭 <strong>المستوى العاشر: الأداء والتحسين</strong></h2>
      <ol>
      <li><p><strong>Performance Optimization</strong></p>
      <ul>
      <li>Lazy loading modules</li>
      <li>Profiling bottlenecks</li>
      <li>Caching responses</li>
      </ul>
      </li>
      <li><p><strong>Global Interceptors for response shaping</strong></p>
      <ul>
      <li>TransformInterceptor</li>
      <li>Response envelope</li>
      </ul>
      </li>
      <li><p><strong>Compression &amp; Response optimization</strong></p>
      </li>
      </ol>
      <hr>
      <p>هل ترغب أن أحوّل هذه القائمة إلى <strong>HTML منسّق وجميل</strong> (مثلاً جدول أو صفحة roadmap بألوان وأقسام collapsible) مثل الملف السابق؟
      سيكون مناسب تستخدمه كـ صفحة مراجعة قبل أي انترفيو.</p>
      
    
      <p>تمام ✅
        خلينا نبدأ بشرح <strong>المستوى الأول من NestJS (Fundamentals)</strong> — ده الأساس اللي لازم تكون فاهمه كويس جدًا علشان تجاوب بثقة في أي مقابلة أو تبني أي مشروع حقيقي.
        هشرح كل نقطة بشكل بسيط + تشبيه من Laravel عشان تكون المقارنة واضحة 👇</p>
        <hr>
        <h2 id="-fundamentals-">🧩 المستوى الأول: <strong>الأساسيات (Fundamentals)</strong></h2>
        <p>يتكوّن من 6 مفاهيم رئيسية:</p>
        <ol>
        <li>ما هو NestJS</li>
        <li>التثبيت والتهيئة</li>
        <li>Modules</li>
        <li>Controllers</li>
        <li>Providers / Services</li>
        <li>Dependency Injection Container</li>
        </ol>
        <hr>
        <h3 id="-1-nestjs-">🔹 1) ما هو NestJS ؟</h3>
        <p><strong>NestJS</strong> هو فريمورك حديث مبني على <strong>Node.js + TypeScript</strong>، هدفه:</p>
        <ul>
        <li>توفير <strong>هيكل منظم للكود</strong> زي Laravel أو Angular.</li>
        <li>تسهيل بناء <strong>تطبيقات Backend قوية</strong> (REST APIs, GraphQL, Microservices).</li>
        <li>العمل فوق <strong>Express</strong> (افتراضيًا) أو <strong>Fastify</strong> (اختياريًا) لتسريع الأداء.</li>
        </ul>
        <p>🎯 <strong>فكر فيه كالتالي:</strong></p>
        <blockquote>
        <p>Express = كود حر غير منظم
        NestJS = Express منظم + TypeScript + أدوات جاهزة + تصميم قابل للتوسع</p>
        </blockquote>
        <hr>
        <h3 id="-2-installation-setup-">🔹 2) التثبيت والتهيئة (Installation &amp; Setup)</h3>
        <h4 id="-nest-cli">تثبيت Nest CLI</h4>
        <p>CLI بيساعدك تولّد ملفات جاهزة زي controllers وmodules بسرعة.</p>
        <pre><code class="lang-bash"><span class="hljs-built_in">npm</span> i -g @nestjs/cli
        nest <span class="hljs-keyword">new</span> my-project
        </code></pre>
        <h4 id="-">ملف المشروع الأساسي</h4>
        <p>بعد التثبيت، هيكون عندك هيكل زي كده:</p>
        <pre><code>src/
         ├── main.<span class="hljs-keyword">ts</span>          # نقطة الدخول
         ├── app.module.<span class="hljs-keyword">ts</span>    # الموديول الرئيسي
         ├── app.controller.<span class="hljs-keyword">ts</span>
         └── app.service.<span class="hljs-keyword">ts</span>
        </code></pre><h4 id="-">شرح الملفات:</h4>
        <ul>
        <li><p><strong>main.ts</strong>
        هو الملف اللي بيشغّل السيرفر باستخدام <code>NestFactory</code>:</p>
        <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { NestFactory } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
        <span class="hljs-keyword">import</span> { AppModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;
        
        <span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bootstrap</span>(<span class="hljs-params"></span>) </span>{
          <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> NestFactory.create(AppModule);
          <span class="hljs-keyword">await</span> app.listen(<span class="hljs-number">3000</span>);
        }
        bootstrap();
        </code></pre>
        </li>
        <li><p><strong>app.module.ts</strong>
        هو الموديول الأساسي اللي بيجمع كل شيء في التطبيق (controllers, providers, imports).</p>
        </li>
        </ul>
        <hr>
        <h3 id="-3-modules-">🔹 3) Modules (الموديولات)</h3>
        <p>الموديول هو <strong>الوحدة التنظيمية الأساسية في NestJS</strong>.
        زي ما في Laravel عندك “Service Providers”، هنا عندك “Modules”.</p>
        <p>كل Module مسؤول عن مجموعة معينة من الوظائف، مثلاً:</p>
        <ul>
        <li>UsersModule</li>
        <li>AuthModule</li>
        <li>ProductsModule</li>
        </ul>
        <pre><code class="lang-ts">// users.<span class="hljs-built_in">module</span>.ts
        <span class="hljs-keyword">import</span> { Module } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
        <span class="hljs-keyword">import</span> { UsersController } <span class="hljs-keyword">from</span> <span class="hljs-string">'./users.controller'</span>;
        <span class="hljs-keyword">import</span> { UsersService } <span class="hljs-keyword">from</span> <span class="hljs-string">'./users.service'</span>;
        
        @Module({
          <span class="hljs-name">controllers</span>: [UsersController],
          <span class="hljs-name">providers</span>: [UsersService],
        })
        <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersModule</span> {}</span>
        </code></pre>
        <p>وبعدين تضيفه في AppModule:</p>
        <pre><code class="lang-ts">@<span class="hljs-keyword">Module</span>({
          <span class="hljs-selector-tag">imports</span>: <span class="hljs-selector-attr">[UsersModule]</span>,
        })
        <span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">AppModule</span> {}
        </code></pre>
        <p>🎯 <strong>الفكرة:</strong>
        الموديول بيلم كل حاجة تخص ميزة معينة (controller + service + repository).</p>
        <hr>
        <h3 id="-4-controllers-">🔹 4) Controllers (المتحكمات)</h3>
        <p>الـ <strong>Controller</strong> هو اللي بيستقبل الـ HTTP requests ويرد بالـ responses.
        زي <strong>Controllers</strong> في Laravel بالضبط.</p>
        <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { Controller, Get } from <span class="hljs-string">'@nestjs/common'</span>;
        <span class="hljs-keyword">import</span> { UsersService } from <span class="hljs-string">'./users.service'</span>;
        
        <span class="hljs-meta">@Controller(<span class="hljs-meta-string">'users'</span>)</span>
        export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> </span>{
          <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">private</span> usersService: UsersService) {}
        
          <span class="hljs-meta">@Get()</span>
          findAll() {
            <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.usersService.findAll();
          }
        }
        </code></pre>
        <ul>
        <li><code>@Controller(&#39;users&#39;)</code> → بيحدد المسار <code>/users</code></li>
        <li><code>@Get()</code> → بيستقبل الطلبات من نوع GET</li>
        <li><code>usersService</code> → بيتحقن أوتوماتيك من NestJS (Dependency Injection)</li>
        </ul>
        <hr>
        <h3 id="-5-providers-services-">🔹 5) Providers / Services (مزودات الخدمات)</h3>
        <p>الـ <strong>Service</strong> هو المكان اللي تكتب فيه المنطق الفعلي (Business Logic).
        زي الـ “Service Classes” أو “Repositories” في Laravel.</p>
        <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { Injectable } from <span class="hljs-string">'@nestjs/common'</span>;
        
        <span class="hljs-meta">@Injectable()</span>
        export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersService</span> </span>{
          findAll() {
            <span class="hljs-keyword">return</span> [<span class="hljs-string">'Ali'</span>, <span class="hljs-string">'Omar'</span>, <span class="hljs-string">'Sara'</span>];
          }
        }
        </code></pre>
        <ul>
        <li><code>@Injectable()</code> معناها إن الكلاس ده ممكن يُحقن في أي مكان.</li>
        <li>NestJS بيسجل الكلاس ده في الـ <strong>DI Container</strong> عشان تقدر تستخدمه في الـ Controller بسهولة.</li>
        </ul>
        <hr>
        <h3 id="-6-dependency-injection-di-container-">🔹 6) Dependency Injection (DI Container)</h3>
        <p><strong>Dependency Injection</strong> معناها:
        بدل ما تنشئ كائنات بنفسك، <strong>NestJS بيحقنها لك تلقائيًا</strong>.
        (زي Laravel’s Service Container)</p>
        <pre><code class="lang-ts"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(<span class="hljs-keyword">private</span> usersService: UsersService)</span> <span class="hljs-comment">{}</span></span>
        </code></pre>
        <p>NestJS عارف إنك محتاج <code>UsersService</code> لأنه:</p>
        <ul>
        <li>الكلاس معرّف بـ <code>@Injectable()</code></li>
        <li>ومضاف كـ <code>provider</code> داخل الموديول</li>
        </ul>
        <p>💡 الفايدة:</p>
        <ul>
        <li>الكود قابل للاختبار</li>
        <li>أقل في الاعتمادية (decoupled)</li>
        <li>أسهل في الصيانة والتوسعة</li>
        </ul>
        <hr>
        <h2 id="-">🧠 ملخص المستوى الأول في جملة واحدة:</h2>
        <blockquote>
        <p>NestJS قائم على فكرة &quot;كل شيء موديول&quot;.
        كل Module يحتوي Controller يستقبل الطلبات وService يحتوي المنطق.
        كل شيء مترابط عبر نظام Dependency Injection — منظم، آمن، وسهل الاختبار.</p>
        </blockquote>
        <hr>
        <p>هل ترغب أن أجهز هذا الشرح في <strong>صفحة HTML منظمة وجميلة</strong> مثل الصفحة السابقة (بألوان + أكواد منسقة + أقسام collapsible)؟
        تكون مفيدة جدًا كمذكرة سريعة قبل الانترفيو.</p>

        <p>تمام ✅
          الآن ننتقل إلى <strong>مستوى 2 – Intermediate (المتوسط)</strong> في NestJS.
          سأشرح لك بالعربية المبسطة مع أمثلة جاهزة يمكنك ذكرها في المقابلات.
          وفي النهاية سأقدمه لك أيضًا في شكل <strong>HTML منسق</strong>.</p>
          <hr>
          <h2 id="-2-nestjs-intermediate-topics-">🧩 المستوى 2 – مفاهيم NestJS المتوسطة (Intermediate Topics)</h2>
          <h3 id="1-modules-in-depth-">1. <strong>Modules in Depth</strong></h3>
          <p>في NestJS كل شيء مبني على مفهوم الـ <strong>Modules</strong>، وهي وحدات تجمع الكود المرتبط معًا (Controllers + Services + Providers).
          مثلاً:</p>
          <ul>
          <li><code>UsersModule</code> يحتوي على <code>UsersController</code> و <code>UsersService</code>.</li>
          <li>كل Module يمكن أن <strong>يستورد</strong> أو <strong>يصدّر</strong> (imports / exports) خدمات من Modules أخرى.</li>
          </ul>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts">@<span class="hljs-keyword">Module</span>({
            <span class="hljs-selector-tag">imports</span>: <span class="hljs-selector-attr">[DatabaseModule]</span>,
            <span class="hljs-selector-tag">controllers</span>: <span class="hljs-selector-attr">[UsersController]</span>,
            <span class="hljs-selector-tag">providers</span>: <span class="hljs-selector-attr">[UsersService]</span>,
            <span class="hljs-selector-tag">exports</span>: <span class="hljs-selector-attr">[UsersService]</span>,
          })
          <span class="hljs-selector-tag">export</span> <span class="hljs-selector-tag">class</span> <span class="hljs-selector-tag">UsersModule</span> {}
          </code></pre>
          <hr>
          <h3 id="2-dependency-injection-di-">2. <strong>Dependency Injection (DI)</strong></h3>
          <p>NestJS يستخدم الـ <strong>Dependency Injection</strong> مثل Laravel&#39;s Service Container.
          يسمح لك بحقن الخدمات داخل الكلاسات بدل ما تنشئها يدويًا.</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts"><span class="hljs-meta">@Injectable()</span>
          export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersService</span> </span>{
            <span class="hljs-keyword">constructor</span>(<span class="hljs-keyword">private</span> readonly dbService: DatabaseService) {}
          }
          </code></pre>
          <p>🔹 الفائدة: سهولة الاختبار، وفصل المهام (Separation of Concerns).</p>
          <hr>
          <h3 id="3-pipes-">3. <strong>Pipes</strong></h3>
          <p>الـ <strong>Pipes</strong> تُستخدم للتحقق من صحة البيانات (Validation) أو لتحويلها (Transformation).
          تشبه <strong>FormRequest</strong> في Laravel.</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts"><span class="hljs-variable">@UsePipes</span>(new ValidationPipe())
          <span class="hljs-variable">@Post</span>()
          createUser(<span class="hljs-variable">@Body</span>() <span class="hljs-attribute">createUserDto</span>: CreateUserDto) {
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.usersService</span><span class="hljs-selector-class">.create</span>(createUserDto);
          }
          </code></pre>
          <p>📘 <strong>Built-in Pipes</strong>:</p>
          <ul>
          <li><code>ValidationPipe</code> (للتحقق)</li>
          <li><code>ParseIntPipe</code> (لتحويل النص إلى رقم)</li>
          <li><code>DefaultValuePipe</code></li>
          </ul>
          <hr>
          <h3 id="4-guards-">4. <strong>Guards</strong></h3>
          <p>الـ <strong>Guards</strong> تحدد من يستطيع الوصول إلى Route معين.
          تشبه <strong>Middleware</strong> في Laravel.</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts"><span class="hljs-meta">@Injectable</span>()
          <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthGuard</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CanActivate</span> </span>{
            canActivate(context: ExecutionContext): boolean {
              <span class="hljs-keyword">const</span> req = context.switchToHttp().getRequest();
              <span class="hljs-keyword">return</span> req.headers.authorization === <span class="hljs-string">'Bearer secret'</span>;
            }
          }
          </code></pre>
          <p>ثم:</p>
          <pre><code class="lang-ts"><span class="hljs-meta">@UseGuards(AuthGuard)</span>
          <span class="hljs-meta">@Get(<span class="hljs-meta-string">'profile'</span>)</span>
          getProfile() { <span class="hljs-keyword">return</span> <span class="hljs-string">'User profile'</span>; }
          </code></pre>
          <hr>
          <h3 id="5-interceptors-">5. <strong>Interceptors</strong></h3>
          <p>الـ <strong>Interceptors</strong> تشبه <strong>Laravel Middleware</strong> لكن أكثر مرونة:</p>
          <ul>
          <li>تعديل <strong>الطلب أو الاستجابة</strong>.</li>
          <li>إضافة <strong>Logging</strong> أو <strong>Caching</strong>.</li>
          </ul>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts">@Injectable()
          export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggingInterceptor</span> <span class="hljs-title">implements</span> <span class="hljs-title">NestInterceptor</span> {</span>
            intercept(context: ExecutionContext, next: CallHandler): Observable&lt;any&gt; {
              <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Before...'</span>);
              <span class="hljs-keyword">return</span> next.handle().pipe(tap(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'After...'</span>)));
            }
          }
          </code></pre>
          <hr>
          <h3 id="6-exception-filters-">6. <strong>Exception Filters</strong></h3>
          <p>تُستخدم لمعالجة الأخطاء بشكل مخصص (Custom Error Handling).</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts">@<span class="hljs-keyword">Catch</span>(HttpException)
          export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">HttpErrorFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ExceptionFilter</span> </span>{
            <span class="hljs-keyword">catch</span>(<span class="hljs-keyword">exception</span>: HttpException, host: ArgumentsHost) {
              <span class="hljs-keyword">const</span> ctx = host.switchToHttp();
              <span class="hljs-keyword">const</span> response = ctx.getResponse&lt;Response&gt;();
              response.status(<span class="hljs-keyword">exception</span>.getStatus()).json({
                success: <span class="hljs-keyword">false</span>,
                message: <span class="hljs-keyword">exception</span>.message,
              });
            }
          }
          </code></pre>
          <p>ثم تستخدمها:</p>
          <pre><code class="lang-ts">@<span class="hljs-keyword">UseFilters</span>(<span class="hljs-keyword">HttpErrorFilter</span>)
          </code></pre>
          <hr>
          <h3 id="7-custom-decorators-">7. <strong>Custom Decorators</strong></h3>
          <p>يمكنك إنشاء Decorator مخصص مثل <code>@User()</code> لاستخراج المستخدم من الطلب.</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts"><span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> User = createParamDecorator(<span class="hljs-function">(<span class="hljs-params">data, ctx: ExecutionContext</span>) =&gt;</span> {
            <span class="hljs-keyword">const</span> request = ctx.switchToHttp().getRequest();
            <span class="hljs-keyword">return</span> request.user;
          });
          </code></pre>
          <p>ثم:</p>
          <pre><code class="lang-ts"><span class="hljs-variable">@Get</span>(<span class="hljs-string">'me'</span>)
          getProfile(<span class="hljs-variable">@User</span>() user) {
            <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">user</span>;
          }
          </code></pre>
          <hr>
          <h3 id="8-configuration-management-">8. <strong>Configuration Management</strong></h3>
          <p>NestJS عنده <code>@nestjs/config</code> لإدارة الإعدادات (env).</p>
          <p>🔹 <strong>مثال:</strong></p>
          <pre><code class="lang-ts"><span class="hljs-selector-tag">ConfigModule</span><span class="hljs-selector-class">.forRoot</span>({
            <span class="hljs-attribute">isGlobal</span>: true,
          });
          </code></pre>
          <p>واستخدامها:</p>
          <pre><code class="lang-ts"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(<span class="hljs-keyword">private</span> configService: ConfigService)</span> <span class="hljs-comment">{
            console.log(configService.get('DATABASE_URL'));
          }</span></span>
          </code></pre>
          <hr>
          <h2 id="-">🎯 ملخص سريع:</h2>
          <table>
          <thead>
          <tr>
          <th>المفهوم</th>
          <th>تشبيهه في Laravel</th>
          <th>الوظيفة</th>
          </tr>
          </thead>
          <tbody>
          <tr>
          <td>Module</td>
          <td>Service Provider</td>
          <td>تجميع الكود</td>
          </tr>
          <tr>
          <td>DI</td>
          <td>Service Container</td>
          <td>حقن الخدمات</td>
          </tr>
          <tr>
          <td>Pipe</td>
          <td>FormRequest</td>
          <td>التحقق من البيانات</td>
          </tr>
          <tr>
          <td>Guard</td>
          <td>Middleware</td>
          <td>التحقق من الصلاحيات</td>
          </tr>
          <tr>
          <td>Interceptor</td>
          <td>Middleware + Filter</td>
          <td>تعديل الطلب والاستجابة</td>
          </tr>
          <tr>
          <td>Exception Filter</td>
          <td>Exception Handler</td>
          <td>التعامل مع الأخطاء</td>
          </tr>
          <tr>
          <td>Custom Decorator</td>
          <td>Helper</td>
          <td>تسهيل الوصول للبيانات</td>
          </tr>
          <tr>
          <td>ConfigModule</td>
          <td>config/env</td>
          <td>إدارة الإعدادات</td>
          </tr>
          </tbody>
          </table>
          <hr>
          <h3 id="-">💡 نصيحة مقابلة:</h3>
          <p>لو سألك المحاور &quot;اشرح لي الفرق بين Pipe و Guard و Interceptor&quot;:</p>
          <blockquote>
          <p>Pipe = validate &amp; transform data
          Guard = check authorization before route runs
          Interceptor = modify request/response before &amp; after controller</p>
          </blockquote>
          <hr>
          <h2 id="-html-">🔖 نفس المحتوى في HTML منسق:</h2>
          <pre><code class="lang-html"><span class="hljs-variable">&lt;section&gt;</span>
            <span class="hljs-variable">&lt;h2&gt;</span>🧩 المستوى 2 – مفاهيم NestJS المتوسطة (Intermediate Topics)<span class="hljs-variable">&lt;/h2&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>1. Modules in Depth<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>الوحدة الأساسية في NestJS هي <span class="hljs-variable">&lt;strong&gt;</span>Module<span class="hljs-variable">&lt;/strong&gt;</span> وتجمع Controllers + Services معًا.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@Module({</span>
            imports: [DatabaseModule],
            controllers: [UsersController],
            providers: [UsersService],
            exports: [UsersService],
          })
          export class UsersModule {}<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>2. Dependency Injection (DI)<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>تُستخدم لحقن الخدمات داخل الكلاسات بدون إنشاء يدوي.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@Injectable()</span>
          export class UsersService {
            constructor(private readonly dbService: DatabaseService) {}
          }<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>3. Pipes<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>للتحقق من البيانات أو تحويلها.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@UsePipes(new</span> ValidationPipe())
          <span class="hljs-meta">@Post()</span>
          createUser(<span class="hljs-meta">@Body()</span> createUserDto: CreateUserDto) {
            return this.usersService.create(createUserDto);
          }<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>4. Guards<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>تشبه Middleware في Laravel، لتحديد صلاحيات الوصول.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@UseGuards(AuthGuard)</span>
          <span class="hljs-meta">@Get('profile')</span>
          getProfile() { return 'User profile'; }<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>5. Interceptors<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>لتعديل الطلب أو الاستجابة.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@Injectable()</span>
          export class LoggingInterceptor implements NestInterceptor {
            intercept(context: ExecutionContext, next: CallHandler): Observable&amp;lt;any&amp;gt; {
              console.log('Before...');
              return next.handle().pipe(tap(() =&amp;gt; console.log('After...')));
            }
          }<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>6. Exception Filters<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>معالجة الأخطاء بشكل مخصص.<span class="hljs-variable">&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;pre&gt;</span><span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@Catch(HttpException)</span>
          export class HttpErrorFilter implements ExceptionFilter {
            catch(exception: HttpException, host: ArgumentsHost) {
              const ctx = host.switchToHttp();
              const response = ctx.getResponse&amp;lt;Response&amp;gt;();
              response.status(exception.getStatus()).json({
                success: false,
                message: exception.message,
              });
            }
          }<span class="hljs-variable">&lt;/code&gt;</span><span class="hljs-variable">&lt;/pre&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>7. Custom Decorators<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>إنشاء Decorator مخصص مثل <span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@User()&lt;/code&gt;.&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;h3&gt;</span>8. Configuration Management<span class="hljs-variable">&lt;/h3&gt;</span>
            <span class="hljs-variable">&lt;p&gt;</span>إدارة الإعدادات عبر <span class="hljs-variable">&lt;code&gt;</span><span class="hljs-meta">@nestjs/config&lt;/code&gt;.&lt;/p&gt;</span>
          
            <span class="hljs-variable">&lt;h4&gt;</span>💡 نصيحة مقابلة:<span class="hljs-variable">&lt;/h4&gt;</span>
            <span class="hljs-variable">&lt;blockquote&gt;</span>
              Pipe = validate &amp; transform data <span class="hljs-variable">&lt;br&gt;</span>
              Guard = check authorization before route runs <span class="hljs-variable">&lt;br&gt;</span>
              Interceptor = modify request/response before &amp; after controller
            <span class="hljs-variable">&lt;/blockquote&gt;</span>
          <span class="hljs-variable">&lt;/section&gt;</span>
          </code></pre>
          <hr>
          <p>هل ترغب أن أبدأ الآن في <strong>المستوى 3 (Advanced Topics)</strong> مع HTML كمان؟</p>
          <p>ممتاز 👏
            الآن ننتقل إلى <strong>المستوى الثالث (Advanced Topics)</strong> في NestJS — هذا المستوى هو ما يميز <strong>المطور السينيور</strong>، وغالبًا يُسأل عنه في المقابلات التقنية.</p>
            <p>سأشرح أولاً بالعربية المبسطة مع أمثلة، ثم أضع لك نسخة <strong>HTML منسقة</strong> لتستخدمها في التحضير أو العرض.</p>
            <hr>
            <h2 id="-3-nestjs-advanced-topics-">🚀 المستوى 3 – مفاهيم NestJS المتقدمة (Advanced Topics)</h2>
            <hr>
            <h3 id="1-middleware-">1. <strong>Middleware (الوسيط)</strong></h3>
            <p>الـ <strong>Middleware</strong> في NestJS يشبه Laravel Middleware — يُنفذ <strong>قبل</strong> وصول الطلب إلى الـ Controller.</p>
            <p>🔹 <strong>الاستخدامات:</strong></p>
            <ul>
            <li>التحقق من التوكن</li>
            <li>تسجيل الطلبات (Logging)</li>
            <li>تعديل جسم الطلب (Request Body)</li>
            </ul>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-meta">@Injectable</span>()
            export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggerMiddleware</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">NestMiddleware</span> {</span>
              use(<span class="hljs-string">req:</span> Request, <span class="hljs-string">res:</span> Response, <span class="hljs-string">next:</span> NextFunction) {
                console.log(`Request... ${req.method} ${req.url}`);
                next();
              }
            }
            </code></pre>
            <p>ثم تسجيله في Module:</p>
            <pre><code class="lang-ts"><span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">NestModule</span> </span>{
              configure(consumer: MiddlewareConsumer) {
                consumer.apply(LoggerMiddleware).forRoutes(<span class="hljs-string">'*'</span>);
              }
            }
            </code></pre>
            <hr>
            <h3 id="2-custom-providers-">2. <strong>Custom Providers</strong></h3>
            <p>NestJS يسمح لك بإنشاء <strong>مزودين مخصصين</strong> للتحكم في طريقة إنشاء الكائنات (Dependency Injection).</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-keyword">const</span> customProvider = {
              provide: <span class="hljs-string">'API_KEY'</span>,
              useValue: <span class="hljs-string">'12345-SECRET'</span>,
            };
            
            <span class="hljs-meta">@Module</span>({
              providers: [customProvider],
            })
            <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> </span>{}
            </code></pre>
            <p>ثم تستخدمه:</p>
            <pre><code class="lang-ts"><span class="hljs-function"><span class="hljs-keyword">constructor</span><span class="hljs-params">(@Inject(<span class="hljs-string">'API_KEY'</span>)</span> <span class="hljs-title">private</span> <span class="hljs-title">apiKey</span>:</span> <span class="hljs-keyword">string</span>) <span class="hljs-comment">{}</span>
            </code></pre>
            <hr>
            <h3 id="3-dynamic-modules-">3. <strong>Dynamic Modules</strong></h3>
            <p>عندما تحتاج إلى <strong>تهيئة Module بشكل ديناميكي</strong> (مثل اتصال بقاعدة بيانات أو مكتبة خارجية).</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-variable">@Module</span>({})
            export class DatabaseModule {
              <span class="hljs-selector-tag">static</span> <span class="hljs-selector-tag">forRoot</span>(<span class="hljs-attribute">options</span>: { <span class="hljs-attribute">uri</span>: string }): <span class="hljs-selector-tag">DynamicModule</span> {
                <span class="hljs-selector-tag">return</span> {
                  <span class="hljs-attribute">module</span>: DatabaseModule,
                  <span class="hljs-attribute">providers</span>: [
                    {
                      <span class="hljs-attribute">provide</span>: <span class="hljs-string">'DB_URI'</span>,
                      <span class="hljs-attribute">useValue</span>: options.uri,
                    },
                  ],
                  <span class="hljs-attribute">exports</span>: [<span class="hljs-string">'DB_URI'</span>],
                };
              }
            }
            </code></pre>
            <p>واستخدامها:</p>
            <pre><code class="lang-ts"><span class="hljs-string">imports:</span> [DatabaseModule.forRoot({ <span class="hljs-string">uri:</span> <span class="hljs-string">'mongodb://localhost:27017/test'</span> })]
            </code></pre>
            <hr>
            <h3 id="4-lifecycle-events-">4. <strong>Lifecycle Events (أحداث دورة الحياة)</strong></h3>
            <p>NestJS يتيح تنفيذ كود في مراحل مختلفة من تشغيل التطبيق:</p>
            <table>
            <thead>
            <tr>
            <th>Event</th>
            <th>Description</th>
            </tr>
            </thead>
            <tbody>
            <tr>
            <td><code>OnModuleInit</code></td>
            <td>عند تهيئة الموديول</td>
            </tr>
            <tr>
            <td><code>OnApplicationBootstrap</code></td>
            <td>عند إقلاع التطبيق</td>
            </tr>
            <tr>
            <td><code>OnModuleDestroy</code></td>
            <td>عند إيقاف الموديول</td>
            </tr>
            <tr>
            <td><code>OnApplicationShutdown</code></td>
            <td>عند إيقاف التطبيق بالكامل</td>
            </tr>
            </tbody>
            </table>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-meta">@Injectable</span>()
            <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppService</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">OnModuleInit</span>, <span class="hljs-title">OnModuleDestroy</span> </span>{
              onModuleInit() {
                console.log(<span class="hljs-string">'Module initialized!'</span>);
              }
              onModuleDestroy() {
                console.log(<span class="hljs-string">'Module destroyed!'</span>);
              }
            }
            </code></pre>
            <hr>
            <h3 id="5-async-providers-">5. <strong>Async Providers</strong></h3>
            <p>تُستخدم لإنشاء <strong>Providers غير متزامنين (Asynchronous)</strong> مثل جلب مفتاح من API قبل التشغيل.</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts">{
              provide: <span class="hljs-string">'ASYNC_KEY'</span>,
              useFactory: <span class="hljs-keyword">async</span> () =&gt; {
                <span class="hljs-keyword">const</span> res = <span class="hljs-keyword">await</span> fetch(<span class="hljs-string">'https://api.example.com/key'</span>);
                <span class="hljs-keyword">return</span> res.text();
              },
            }
            </code></pre>
            <hr>
            <h3 id="6-global-modules-">6. <strong>Global Modules</strong></h3>
            <p>لجعل Module متاحًا في جميع أجزاء التطبيق دون الحاجة إلى استيراده يدويًا.</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-variable">@Global</span>()
            <span class="hljs-variable">@Module</span>({
              <span class="hljs-attribute">providers</span>: [ConfigService],
              <span class="hljs-attribute">exports</span>: [ConfigService],
            })
            export class GlobalConfigModule {}
            </code></pre>
            <hr>
            <h3 id="7-interacting-with-databases-">7. <strong>Interacting with Databases</strong></h3>
            <p>NestJS يدعم مكتبات كثيرة:</p>
            <ul>
            <li><strong>TypeORM</strong></li>
            <li><strong>Mongoose</strong></li>
            <li><strong>Prisma</strong></li>
            </ul>
            <p>🔹 <strong>مثال باستخدام TypeORM:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-selector-tag">TypeOrmModule</span><span class="hljs-selector-class">.forRoot</span>({
              <span class="hljs-attribute">type</span>: <span class="hljs-string">'mysql'</span>,
              <span class="hljs-attribute">host</span>: <span class="hljs-string">'localhost'</span>,
              <span class="hljs-attribute">username</span>: <span class="hljs-string">'root'</span>,
              <span class="hljs-attribute">password</span>: <span class="hljs-string">''</span>,
              <span class="hljs-attribute">database</span>: <span class="hljs-string">'test'</span>,
              <span class="hljs-attribute">autoLoadEntities</span>: true,
              <span class="hljs-attribute">synchronize</span>: true,
            });
            </code></pre>
            <hr>
            <h3 id="8-microservices-architecture-">8. <strong>Microservices Architecture</strong></h3>
            <p>NestJS يدعم بناء <strong>أنظمة Microservices</strong> بسهولة باستخدام Transport مثل:</p>
            <ul>
            <li>TCP</li>
            <li>Redis</li>
            <li>Kafka</li>
            <li>RabbitMQ</li>
            </ul>
            <p>🔹 <strong>مثال TCP Server:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-keyword">const</span> app = <span class="hljs-function">await NestFactory.<span class="hljs-title">createMicroservice</span><span class="hljs-params">(AppModule, {
              transport: Transport.TCP,
              options: { host: <span class="hljs-string">'127.0.0.1'</span>, port: <span class="hljs-number">8877</span> },
            })</span></span>;
            <span class="hljs-function">await app.<span class="hljs-title">listen</span><span class="hljs-params">()</span></span>;
            </code></pre>
            <p>🔹 <strong>Client Side:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-selector-tag">client</span><span class="hljs-selector-class">.send</span>({ <span class="hljs-attribute">cmd</span>: <span class="hljs-string">'get_user'</span> }, <span class="hljs-selector-tag">userId</span>);
            </code></pre>
            <hr>
            <h3 id="9-graphql-integration-">9. <strong>GraphQL Integration</strong></h3>
            <p>NestJS يوفر دعمًا أصليًا لـ GraphQL عبر <code>@nestjs/graphql</code>.</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-variable">@Resolver</span>()
            export class UsersResolver {
              <span class="hljs-selector-tag">constructor</span>(private <span class="hljs-attribute">usersService</span>: UsersService) {}
            
              <span class="hljs-variable">@Query</span>(() =&gt; [User])
              users() {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.usersService</span><span class="hljs-selector-class">.findAll</span>();
              }
            }
            </code></pre>
            <hr>
            <h3 id="10-eventemitter-cqrs-">10. <strong>EventEmitter / CQRS</strong></h3>
            <p>NestJS يدعم <strong>Event-Driven Architecture</strong> من خلال <code>@nestjs/event-emitter</code> أو <code>@nestjs/cqrs</code>.</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts"><span class="hljs-built_in">this</span>.eventEmitter.emit(<span class="hljs-string">'user.created'</span>, <span class="hljs-keyword">new</span><span class="hljs-type">User</span>);
            </code></pre>
            <hr>
            <h3 id="11-testing-unit-e2e-">11. <strong>Testing (Unit &amp; E2E)</strong></h3>
            <p>NestJS مهيأ لاختبارات الوحدات عبر Jest.</p>
            <p>🔹 <strong>مثال:</strong></p>
            <pre><code class="lang-ts">describe('AppController', () =&gt; {
              it('should return <span class="hljs-string">"Hello World!"</span>', () =&gt; {
                expect(<span class="hljs-name">appController</span>.getHello()).toBe('Hello World!')<span class="hljs-comment">;</span>
              })<span class="hljs-comment">;</span>
            })<span class="hljs-comment">;</span>
            </code></pre>
            <hr>
            <h2 id="-">🧠 ملخص سريع</h2>
            <table>
            <thead>
            <tr>
            <th>المفهوم</th>
            <th>الفائدة</th>
            </tr>
            </thead>
            <tbody>
            <tr>
            <td>Middleware</td>
            <td>تنفيذ كود قبل وصول الطلب للـ Controller</td>
            </tr>
            <tr>
            <td>Custom Providers</td>
            <td>تحكم في إنشاء واعتماد الخدمات</td>
            </tr>
            <tr>
            <td>Dynamic Modules</td>
            <td>إنشاء Modules مرنة قابلة للتهيئة</td>
            </tr>
            <tr>
            <td>Lifecycle Hooks</td>
            <td>تنفيذ كود أثناء التشغيل أو الإغلاق</td>
            </tr>
            <tr>
            <td>Async Providers</td>
            <td>تحميل بيانات قبل التشغيل</td>
            </tr>
            <tr>
            <td>Global Modules</td>
            <td>جعل الخدمات متاحة عالميًا</td>
            </tr>
            <tr>
            <td>Microservices</td>
            <td>بناء أنظمة موزعة وقابلة للتوسع</td>
            </tr>
            <tr>
            <td>GraphQL</td>
            <td>API أكثر مرونة</td>
            </tr>
            <tr>
            <td>CQRS/EventEmitter</td>
            <td>فصل القراءة عن الكتابة وإدارة الأحداث</td>
            </tr>
            <tr>
            <td>Testing</td>
            <td>تأكيد استقرار الكود</td>
            </tr>
            </tbody>
            </table>
            <hr>
            <h3 id="-">🎯 نصيحة مقابلة:</h3>
            <blockquote>
            <p>💬 &quot;NestJS allows building scalable and testable architectures using dependency injection, modular structure, and microservices support.
            I’ve used middleware, interceptors, and dynamic modules to keep my app flexible and maintainable.&quot;</p>
            </blockquote>
            <hr>
            <h2 id="-html-">🔖 نفس المحتوى بصيغة HTML منسقة:</h2>
            <pre><code class="lang-html"><span class="xml"><span class="hljs-tag">&lt;<span class="hljs-name">section</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">h2</span>&gt;</span>🚀 المستوى 3 – مفاهيم NestJS المتقدمة (Advanced Topics)<span class="hljs-tag">&lt;/<span class="hljs-name">h2</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>1. Middleware<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>تنفذ قبل الـ Controller لتعديل الطلب أو تسجيله.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">pre</span>&gt;</span><span class="hljs-tag">&lt;<span class="hljs-name">code</span>&gt;</span>@Injectable()
            export class LoggerMiddleware implements NestMiddleware </span><span class="hljs-template-variable">{
              use(req, res, next) {
                console.log(`Request... ${req.method}</span><span class="xml"> $</span><span class="hljs-template-variable">{req.url}</span><span class="xml">`);
                next();
              }
            }<span class="hljs-tag">&lt;/<span class="hljs-name">code</span>&gt;</span><span class="hljs-tag">&lt;/<span class="hljs-name">pre</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>2. Custom Providers<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>مزودين مخصصين للتحكم في القيم المحقونة.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>3. Dynamic Modules<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>Modules مرنة يمكن تهيئتها ديناميكيًا.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>4. Lifecycle Hooks<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>تشغيل كود عند بدء أو إيقاف التطبيق.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>5. Async Providers<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>تحميل القيم بشكل غير متزامن.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>6. Global Modules<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>جعل Module متاحًا في كل التطبيق.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>7. Databases Integration<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">ul</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>TypeORM<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Mongoose<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
                <span class="hljs-tag">&lt;<span class="hljs-name">li</span>&gt;</span>Prisma<span class="hljs-tag">&lt;/<span class="hljs-name">li</span>&gt;</span>
              <span class="hljs-tag">&lt;/<span class="hljs-name">ul</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>8. Microservices<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>بناء أنظمة موزعة باستخدام TCP / Redis / Kafka / RabbitMQ.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>9. GraphQL<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>إنشاء واجهات برمجة مرنة باستخدام GraphQL.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>10. CQRS / EventEmitter<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>تصميم يعتمد على الأحداث.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">h3</span>&gt;</span>11. Testing<span class="hljs-tag">&lt;/<span class="hljs-name">h3</span>&gt;</span>
              <span class="hljs-tag">&lt;<span class="hljs-name">p</span>&gt;</span>باستخدام Jest لاختبارات الوحدات والتكامل.<span class="hljs-tag">&lt;/<span class="hljs-name">p</span>&gt;</span>
            
              <span class="hljs-tag">&lt;<span class="hljs-name">blockquote</span>&gt;</span>
                💬 NestJS allows building scalable and testable architectures using dependency injection and microservices.
              <span class="hljs-tag">&lt;/<span class="hljs-name">blockquote</span>&gt;</span>
            <span class="hljs-tag">&lt;/<span class="hljs-name">section</span>&gt;</span></span>
            </code></pre>
            <hr>
            <p>هل ترغب أن أشرح لك <strong>المستوى 4 (Expert Topics)</strong> مثل Microservices, Caching, Queues, Security, Performance، إلخ؟</p>

            <p>تمام ✅
              إليك <strong>Level 5: Middleware, Guards, Interceptors &amp; Pipes</strong> مكتوبًا بصيغة <strong>Markdown</strong> منظمة وواضحة — هذا المستوى مهم جدًا لأنه يشرح كيف تتحكم في سلوك الطلبات داخل NestJS مثل الـ Middleware في Laravel.</p>
              <hr>
              <h1 id="-level-5-middleware-guards-interceptors-pipes">⚙️ Level 5: Middleware, Guards, Interceptors &amp; Pipes</h1>
              <p>في هذا المستوى ستتعلم أهم الأدوات التي يستخدمها NestJS للتحكم في تدفق الطلبات، والتحقق من الصلاحيات، وتنفيذ التحويلات أو التحقق من البيانات قبل وصولها إلى الـ Controller.</p>
              <hr>
              <h2 id="1-middleware">1. Middleware</h2>
              <h3 id="-">🔹 التعريف</h3>
              <p>الـ <strong>Middleware</strong> هو كود يتم تنفيذه <strong>قبل الوصول إلى الـ Route Handler (Controller)</strong>، ويُستخدم عادةً من أجل:</p>
              <ul>
              <li>تسجيل الطلبات (logging)</li>
              <li>فحص التوكنات</li>
              <li>تعديل الطلبات قبل معالجتها</li>
              </ul>
              <h3 id="-">🔹 المثال:</h3>
              <pre><code class="lang-ts"><span class="hljs-comment">// logger.middleware.ts</span>
              <span class="hljs-keyword">import</span> { Injectable, NestMiddleware } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
              <span class="hljs-keyword">import</span> { Request, Response, NextFunction } <span class="hljs-keyword">from</span> <span class="hljs-string">'express'</span>;
              
              @Injectable()
              <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggerMiddleware</span> <span class="hljs-title">implements</span> <span class="hljs-title">NestMiddleware</span> </span>{
                use(req: Request, <span class="hljs-attr">res</span>: Response, <span class="hljs-attr">next</span>: NextFunction) {
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`Request... <span class="hljs-subst">${req.method}</span> <span class="hljs-subst">${req.url}</span>`</span>);
                  next(); <span class="hljs-comment">// ضروري للسماح بتمرير الطلب</span>
                }
              }
              </code></pre>
              <h3 id="-module-">🔹 التسجيل داخل Module:</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { MiddlewareConsumer, Module, NestModule } from <span class="hljs-string">'@nestjs/common'</span>;
              <span class="hljs-keyword">import</span> { UsersController } from <span class="hljs-string">'./users.controller'</span>;
              <span class="hljs-keyword">import</span> { LoggerMiddleware } from <span class="hljs-string">'./logger.middleware'</span>;
              
              <span class="hljs-meta">@Module</span>({ <span class="hljs-string">controllers:</span> [UsersController] })
              export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersModule</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">NestModule</span> {</span>
                configure(<span class="hljs-string">consumer:</span> MiddlewareConsumer) {
                  consumer.apply(LoggerMiddleware).forRoutes(UsersController);
                }
              }
              </code></pre>
              <hr>
              <h2 id="2-guards">2. Guards</h2>
              <h3 id="-">🔹 التعريف</h3>
              <p>الـ <strong>Guards</strong> تُستخدم للتحكم في الوصول (Authorization).
              فكر فيها كأنها <strong>Middleware متقدمة</strong> تحدد هل يُسمح للمستخدم بالوصول إلى route أم لا.</p>
              <h3 id="-">🔹 الاستخدامات الشائعة</h3>
              <ul>
              <li>حماية الـ Routes الخاصة بالمستخدمين المسجلين فقط.</li>
              <li>التحقق من الأدوار (roles).</li>
              </ul>
              <h3 id="-">🔹 المثال:</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { CanActivate, ExecutionContext, Injectable } from <span class="hljs-string">'@nestjs/common'</span>;
              
              <span class="hljs-meta">@Injectable</span>()
              <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthGuard</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">CanActivate</span> </span>{
                canActivate(context: ExecutionContext): boolean {
                  <span class="hljs-keyword">const</span> request = context.switchToHttp().getRequest();
                  <span class="hljs-keyword">return</span> request.headers.authorization === <span class="hljs-string">'Bearer mysecrettoken'</span>;
                }
              }
              </code></pre>
              <h3 id="-guard-route-">🔹 تطبيق الـ Guard على Route:</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { UseGuards, Controller, Get } from <span class="hljs-string">'@nestjs/common'</span>;
              <span class="hljs-keyword">import</span> { AuthGuard } from <span class="hljs-string">'./auth.guard'</span>;
              
              <span class="hljs-meta">@Controller(<span class="hljs-meta-string">'users'</span>)</span>
              export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">UsersController</span> </span>{
                <span class="hljs-meta">@Get()</span>
                <span class="hljs-meta">@UseGuards(AuthGuard)</span>
                findAll() {
                  <span class="hljs-keyword">return</span> [<span class="hljs-string">'Ali'</span>, <span class="hljs-string">'Sara'</span>];
                }
              }
              </code></pre>
              <hr>
              <h2 id="3-interceptors">3. Interceptors</h2>
              <h3 id="-">🔹 التعريف</h3>
              <p>الـ <strong>Interceptors</strong> تشبه الـ Middleware، لكنها تعمل <strong>قبل وبعد تنفيذ الدالة</strong>.
              يمكنك استخدامها مثلاً لـ:</p>
              <ul>
              <li>تعديل البيانات قبل الإرسال أو بعد الاستقبال.</li>
              <li>تسجيل زمن تنفيذ الطلب.</li>
              <li>تطبيق الـ caching.</li>
              </ul>
              <h3 id="-">🔹 المثال:</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { Injectable, NestInterceptor, ExecutionContext, CallHandler } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
              <span class="hljs-keyword">import</span> { Observable, tap } <span class="hljs-keyword">from</span> <span class="hljs-string">'rxjs'</span>;
              
              @Injectable()
              <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">LoggingInterceptor</span> <span class="hljs-title">implements</span> <span class="hljs-title">NestInterceptor</span> </span>{
                intercept(context: ExecutionContext, <span class="hljs-attr">next</span>: CallHandler): Observable&lt;any&gt; {
                  <span class="hljs-keyword">const</span> now = <span class="hljs-built_in">Date</span>.now();
                  <span class="hljs-built_in">console</span>.log(<span class="hljs-string">'Before...'</span>);
                  <span class="hljs-keyword">return</span> next
                    .handle()
                    .pipe(tap(<span class="hljs-function"><span class="hljs-params">()</span> =&gt;</span> <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`After... <span class="hljs-subst">${<span class="hljs-built_in">Date</span>.now() - now}</span>ms`</span>)));
                }
              }
              </code></pre>
              <h3 id="-">🔹 التطبيق:</h3>
              <pre><code class="lang-ts"><span class="hljs-variable">@UseInterceptors</span>(LoggingInterceptor)
              <span class="hljs-variable">@Get</span>()
              getUsers() {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-attr">['Ali', 'Sara']</span>;
              }
              </code></pre>
              <hr>
              <h2 id="4-pipes">4. Pipes</h2>
              <h3 id="-">🔹 التعريف</h3>
              <p>الـ <strong>Pipes</strong> تُستخدم لمعالجة <strong>البيانات القادمة من المستخدم</strong> (Validation &amp; Transformation) قبل أن تصل إلى الـ Controller.</p>
              <h3 id="-">🔹 الاستخدامات</h3>
              <ul>
              <li>التحقق من البيانات (Validation)</li>
              <li>تحويل القيم إلى أنواع معينة (Transformation)</li>
              </ul>
              <h3 id="-pipe-">🔹 مثال: Pipe بسيط</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { PipeTransform, Injectable, ArgumentMetadata, BadRequestException } from <span class="hljs-string">'@nestjs/common'</span>;
              
              <span class="hljs-meta">@Injectable</span>()
              <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">ParseIntPipe</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">PipeTransform</span> </span>{
                transform(value: any, metadata: ArgumentMetadata) {
                  <span class="hljs-keyword">const</span> val = parseInt(value, <span class="hljs-number">10</span>);
                  <span class="hljs-keyword">if</span> (isNaN(val)) {
                    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> BadRequestException(<span class="hljs-string">'Validation failed'</span>);
                  }
                  <span class="hljs-keyword">return</span> val;
                }
              }
              </code></pre>
              <h3 id="-controller-">🔹 استخدامه في Controller:</h3>
              <pre><code class="lang-ts"><span class="hljs-variable">@Get</span>(<span class="hljs-string">':id'</span>)
              findOne(<span class="hljs-variable">@Param</span>(<span class="hljs-string">'id'</span>, ParseIntPipe) <span class="hljs-attribute">id</span>: number) {
                <span class="hljs-selector-tag">return</span> { <span class="hljs-selector-tag">id</span> };
              }
              </code></pre>
              <hr>
              <h2 id="5-built-in-pipes">5. Built-in Pipes</h2>
              <p>NestJS يأتي بعدة Pipes جاهزة مثل:</p>
              <ul>
              <li><code>ValidationPipe</code> ✅ للتحقق من المدخلات باستخدام <strong>class-validator</strong></li>
              <li><code>ParseIntPipe</code> 🔢 لتحويل القيم إلى أعداد</li>
              <li><code>DefaultValuePipe</code> لتعيين قيمة افتراضية</li>
              </ul>
              <h3 id="-validationpipe-">🔹 مثال باستخدام ValidationPipe:</h3>
              <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { IsString, IsEmail } <span class="hljs-keyword">from</span> <span class="hljs-string">'class-validator'</span>;
              
              <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUserDto</span> {</span>
                @IsString()
                <span class="hljs-name">name</span>: <span class="hljs-built_in">string</span>;
              
                @IsEmail()
                <span class="hljs-name">email</span>: <span class="hljs-built_in">string</span>;
              }
              </code></pre>
              <pre><code class="lang-ts"><span class="hljs-variable">@Post</span>()
              create(<span class="hljs-variable">@Body</span>(new ValidationPipe()) <span class="hljs-attribute">user</span>: CreateUserDto) {
                <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">user</span>;
              }
              </code></pre>
              <hr>
              <h2 id="6-execution-order-">6. ترتيب التنفيذ (Execution Order)</h2>
              <ol>
              <li><strong>Middleware</strong></li>
              <li><strong>Guards</strong></li>
              <li><strong>Interceptors (قبل)</strong></li>
              <li><strong>Pipes</strong></li>
              <li><strong>Controller / Handler</strong></li>
              <li><strong>Interceptors (بعد)</strong></li>
              </ol>
              <hr>
              <h2 id="-5">🎯 المهارات بعد المستوى 5</h2>
              <p>بعد إنهاء هذا المستوى، ستكون قادرًا على:</p>
              <ul>
              <li>كتابة Middleware مخصصة للتحكم في الطلبات.</li>
              <li>بناء Guards للتحكم في الوصول.</li>
              <li>استخدام Interceptors لتسجيل الأداء أو تعديل الردود.</li>
              <li>تطبيق Pipes للتحقق من البيانات وتحويلها بسهولة.</li>
              </ul>
              <hr>
              <p>هل ترغب أن أرسل لك المستوى <strong>Level 6 (Asynchronous Programming &amp; Exception Filters)</strong> أيضًا بصيغة Markdown؟</p>

              <p>تمام ✅ جميل جدًا — بما إنك وصلت إلى <strong>Level 6 (Expert+)</strong>، فهذا هو أعلى مستوى ممكن في NestJS.
                في هذا المستوى بنتعامل مع <strong>architectural mastery</strong>, <strong>enterprise patterns</strong>, <strong>multi-service orchestration</strong>, <strong>advanced security</strong>, و<strong>real production scaling</strong>.
                الهدف أنك تكون في مستوى <strong>Tech Lead / Senior Architect</strong>.</p>
                <p>فيما يلي الشرح الكامل بصيغة <strong>Markdown (md)</strong> مرتبة ومناسبة للمقابلات التقنية أو الـPortfolio.</p>
                <hr>
                <h1 id="-nestjs-level-6-expert-architect-level-">🏗️ NestJS – Level 6 (Expert+ / Architect Level)</h1>
                <blockquote>
                <p>⚙️ الهدف من هذا المستوى هو تصميم أنظمة معقدة، آمنة، وقابلة للتوسع باستخدام NestJS، مع فهم عميق للـ architecture والـ DevOps.</p>
                </blockquote>
                <hr>
                <h2 id="1-clean-architecture-hexagonal-design-">1. <strong>Clean Architecture + Hexagonal Design</strong></h2>
                <h3 id="-">🎯 الفكرة:</h3>
                <p>فصل طبقات المشروع عن بعضها (Domain, Application, Infrastructure).
                الـ <strong>NestJS Modules</strong> تساعدك على تطبيق هذا النمط بسهولة.</p>
                <pre><code>src/
                 ├── domain/
                 │   ├── entities/
                 │   └── services/
                 ├── application/
                 │   ├── <span class="hljs-keyword">use</span>-cases/
                 │   └── ports/
                 └── infrastructure/
                     ├── <span class="hljs-keyword">database</span>/
                     ├── <span class="hljs-keyword">http</span>/
                     └── config/
                </code></pre><ul>
                <li><strong>Domain Layer</strong> → منطق الأعمال (Entities, Rules)</li>
                <li><strong>Application Layer</strong> → الـ Use Cases</li>
                <li><strong>Infrastructure Layer</strong> → قواعد البيانات، APIs، إلخ.</li>
                </ul>
                <p>🔹 <strong>الهدف:</strong>
                كل طبقة مستقلة وقابلة للاختبار بدون الاعتماد على أخرى.</p>
                <hr>
                <h2 id="2-cqrs-event-sourcing-enterprise-pattern-">2. <strong>CQRS + Event Sourcing (Enterprise Pattern)</strong></h2>
                <h3 id="-cqrs-command-query-responsibility-segregation-">⚡ CQRS (Command Query Responsibility Segregation)</h3>
                <p>يعني فصل أوامر <strong>الكتابة (Command)</strong> عن <strong>القراءة (Query)</strong>.</p>
                <ul>
                <li>Command: <code>createUserCommandHandler</code></li>
                <li>Query: <code>getUserQueryHandler</code></li>
                </ul>
                <p>🔹 <strong>مثال:</strong></p>
                <pre><code class="lang-ts"><span class="hljs-meta">@CommandHandler</span>(CreateUserCommand)
                <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">CreateUserHandler</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ICommandHandler</span>&lt;<span class="hljs-title">CreateUserCommand</span>&gt; </span>{
                  <span class="hljs-keyword">async</span> execute(command: CreateUserCommand) {
                    <span class="hljs-comment">// handle create user</span>
                  }
                }
                </code></pre>
                <h3 id="-event-sourcing">⚡ Event Sourcing</h3>
                <p>بدل تخزين الحالة النهائية في DB، نخزن <strong>كل الأحداث التي حصلت</strong>.
                وعند الحاجة نحسب الحالة من الأحداث.</p>
                <hr>
                <h2 id="3-advanced-microservices-orchestration-">3. <strong>Advanced Microservices Orchestration</strong></h2>
                <h3 id="-">🧩 المفاهيم:</h3>
                <ul>
                <li>Service Discovery (مثل Consul أو Eureka)</li>
                <li>Load Balancing</li>
                <li>Distributed Transactions (Saga Pattern)</li>
                <li>API Gateway (NestJS Gateway أو Kong أو Nginx)</li>
                <li>Circuit Breaker (مثل <code>@nestjs/terminus</code>)</li>
                </ul>
                <p>🔹 <strong>Saga Pattern Example:</strong></p>
                <pre><code class="lang-ts"><span class="hljs-meta">@Saga</span>()
                orderCreated = (events$: Observable&lt;any&gt;) =&gt;
                  events$.pipe(
                    ofType(OrderCreatedEvent),
                    map(event =&gt; <span class="hljs-keyword">new</span> ReserveInventoryCommand(event.orderId))
                  );
                </code></pre>
                <hr>
                <h2 id="4-api-gateway-federation-">4. <strong>API Gateway &amp; Federation</strong></h2>
                <h3 id="-nestjs-microservices-graphql-federation-">🛡️ باستخدام NestJS Microservices أو GraphQL Federation:</h3>
                <ul>
                <li>توحد جميع الخدمات خلف Gateway واحد.</li>
                <li>تتحكم في <strong>Auth, Rate Limit, Caching</strong>.</li>
                <li>Gateway يستدعي Services داخل الـ cluster.</li>
                </ul>
                <p>🔹 <strong>NestJS API Gateway Example:</strong></p>
                <pre><code class="lang-ts"><span class="hljs-variable">@Controller</span>(<span class="hljs-string">'users'</span>)
                export class UsersGatewayController {
                  <span class="hljs-selector-tag">constructor</span>(<span class="hljs-variable">@Inject</span>(<span class="hljs-string">'USER_SERVICE'</span>) private <span class="hljs-attribute">client</span>: ClientProxy) {}
                
                  <span class="hljs-variable">@Get</span>()
                  getAll() {
                    <span class="hljs-selector-tag">return</span> <span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.client</span><span class="hljs-selector-class">.send</span>({ <span class="hljs-attribute">cmd</span>: <span class="hljs-string">'get_users'</span> }, {});
                  }
                }
                </code></pre>
                <hr>
                <h2 id="5-observability-logging-metrics-tracing-">5. <strong>Observability (Logging + Metrics + Tracing)</strong></h2>
                <h3 id="-">📈 أدوات:</h3>
                <ul>
                <li><strong>Prometheus</strong> → metrics</li>
                <li><strong>Grafana</strong> → dashboards</li>
                <li><strong>OpenTelemetry</strong> → tracing</li>
                <li><strong>Winston / Pino</strong> → logging</li>
                </ul>
                <p>🔹 <strong>Example Integration:</strong></p>
                <pre><code class="lang-ts"><span class="hljs-keyword">import</span> { Logger } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
                <span class="hljs-keyword">import</span> { OpenTelemetryModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'nestjs-otel'</span>;
                
                @Module({
                  imports: [OpenTelemetryModule.forRoot()],
                  providers: [Logger],
                })
                <span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">MonitoringModule</span> {}</span>
                </code></pre>
                <hr>
                <h2 id="6-distributed-caching-multi-layer-caching-">6. <strong>Distributed Caching &amp; Multi-Layer Caching</strong></h2>
                <p>Use multi-level caching to reduce latency:</p>
                <ul>
                <li><strong>In-memory (Node)</strong> for instant lookups</li>
                <li><strong>Redis / Memcached</strong> for shared caching</li>
                <li><strong>CDN caching</strong> for static assets</li>
                </ul>
                <p>🔹 <strong>Pattern Example:</strong></p>
                <pre><code class="lang-ts"><span class="hljs-keyword">async</span> getUser(<span class="hljs-attribute">id:</span><span class="hljs-string"> number</span>) {
                  <span class="hljs-keyword">const</span> cached = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.redis.get(<span class="hljs-string">`user:<span class="hljs-subst">${id}</span>`</span>);
                  <span class="hljs-keyword">if</span> (cached) <span class="hljs-keyword">return</span> <span class="hljs-built_in">JSON</span>.parse(cached);
                
                  <span class="hljs-keyword">const</span> user = <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.db.findUserById(id);
                  <span class="hljs-keyword">await</span> <span class="hljs-keyword">this</span>.redis.set(<span class="hljs-string">`user:<span class="hljs-subst">${id}</span>`</span>, <span class="hljs-built_in">JSON</span>.stringify(user), <span class="hljs-string">'EX'</span>, <span class="hljs-number">60</span>);
                  <span class="hljs-keyword">return</span> user;
                }
                </code></pre>
                <hr>
                <h2 id="7-advanced-security-zero-trust-">7. <strong>Advanced Security &amp; Zero Trust</strong></h2>
                <ul>
                <li>JWT rotation &amp; refresh tokens</li>
                <li>Multi-tenant Auth</li>
                <li>RBAC (Role-based access control)</li>
                <li>Encryption using AES-256</li>
                <li>API key management</li>
                <li>Service-to-service authentication (mTLS)</li>
                </ul>
                <p>🔹 <strong>Example:</strong></p>
                <pre><code class="lang-ts">app.useGlobalGuards(<span class="hljs-keyword">new</span> <span class="hljs-type">RolesGuard</span>([<span class="hljs-string">'admin'</span>]));
                </code></pre>
                <hr>
                <h2 id="8-multi-tenancy-architecture-">8. <strong>Multi-Tenancy Architecture</strong></h2>
                <p>NestJS يمكنه دعم أكثر من عميل (tenant) داخل نفس التطبيق.</p>
                <h3 id="-approaches-">🏢 Approaches:</h3>
                <ul>
                <li>Database per tenant</li>
                <li>Schema per tenant</li>
                <li>Row-based tenant ID filtering</li>
                </ul>
                <p>🔹 <strong>Example using middleware:</strong></p>
                <pre><code class="lang-ts">req.tenantId = extractTenantIdFromHost(req.hostname)<span class="hljs-comment">;</span>
                </code></pre>
                <hr>
                <h2 id="9-serverless-with-nestjs-">9. <strong>Serverless with NestJS</strong></h2>
                <p>NestJS works with AWS Lambda, Google Cloud Functions, Azure Functions.</p>
                <p>🔹 <strong>Example:</strong></p>
                <pre><code class="lang-bash"><span class="hljs-built_in">npm</span> install @nestjs/cli serverless-http
                </code></pre>
                <pre><code class="lang-ts"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> serverless <span class="hljs-keyword">from</span> <span class="hljs-string">'serverless-http'</span>;
                <span class="hljs-keyword">export</span> <span class="hljs-keyword">const</span> handler = serverless(app.getHttpAdapter().getInstance());
                </code></pre>
                <hr>
                <h2 id="10-devops-ci-cd-integration-">10. <strong>DevOps + CI/CD Integration</strong></h2>
                <ul>
                <li>Docker + Docker Compose</li>
                <li>GitHub Actions / GitLab CI</li>
                <li>Kubernetes deployment</li>
                <li>Secrets management (Vault / AWS Secrets Manager)</li>
                </ul>
                <p>🔹 <strong>Dockerfile Example:</strong></p>
                <pre><code class="lang-dockerfile"><span class="hljs-keyword">FROM</span> node:<span class="hljs-number">20</span>
                <span class="hljs-keyword">WORKDIR</span><span class="bash"> /app
                </span><span class="hljs-keyword">COPY</span><span class="bash"> package*.json ./
                </span><span class="hljs-keyword">RUN</span><span class="bash"> npm ci
                </span><span class="hljs-keyword">COPY</span><span class="bash"> . .
                </span><span class="hljs-keyword">RUN</span><span class="bash"> npm run build
                </span><span class="hljs-keyword">CMD</span><span class="bash"> [<span class="hljs-string">"node"</span>, <span class="hljs-string">"dist/main.js"</span>]</span>
                </code></pre>
                <hr>
                <h2 id="11-resilience-fault-tolerance-">11. <strong>Resilience &amp; Fault Tolerance</strong></h2>
                <p>Implement:</p>
                <ul>
                <li><strong>Circuit Breakers</strong> (via <code>@nestjs/terminus</code>)</li>
                <li><strong>Retry Strategies</strong></li>
                <li><strong>Bulkhead Isolation</strong></li>
                <li><strong>Timeout Policies</strong></li>
                </ul>
                <p>🔹 Example:</p>
                <pre><code class="lang-ts"><span class="hljs-selector-tag">this</span><span class="hljs-selector-class">.httpService</span><span class="hljs-selector-class">.get</span>(<span class="hljs-selector-tag">url</span>)<span class="hljs-selector-class">.pipe</span>(<span class="hljs-selector-tag">retry</span>(3), <span class="hljs-selector-tag">timeout</span>(5000));
                </code></pre>
                <hr>
                <h2 id="12-ai-nestjs-integration-">12. <strong>AI + NestJS Integration</strong></h2>
                <p>Use NestJS as backend for AI APIs:</p>
                <ul>
                <li>OpenAI / Hugging Face integration</li>
                <li>Queue for async model inference</li>
                <li>Caching model responses</li>
                <li>WebSocket streaming for chatbots</li>
                </ul>
                <p>🔹 Example:</p>
                <pre><code class="lang-ts"><span class="hljs-meta">@Post(<span class="hljs-meta-string">'ask'</span>)</span>
                async askAI(<span class="hljs-meta">@Body(<span class="hljs-meta-string">'prompt'</span>)</span> prompt: string) {
                  const response = await <span class="hljs-keyword">this</span>.openai.createCompletion({ model: <span class="hljs-string">'gpt-4'</span>, prompt });
                  <span class="hljs-keyword">return</span> response.<span class="hljs-keyword">data</span>;
                }
                </code></pre>
                <hr>
                <h2 id="-summary-table">✅ Summary Table</h2>
                <table>
                <thead>
                <tr>
                <th>Concept</th>
                <th>Description</th>
                </tr>
                </thead>
                <tbody>
                <tr>
                <td>Clean Architecture</td>
                <td>Layered, maintainable design</td>
                </tr>
                <tr>
                <td>CQRS &amp; Event Sourcing</td>
                <td>Separate reads/writes &amp; store events</td>
                </tr>
                <tr>
                <td>Microservices Orchestration</td>
                <td>Managing distributed flows</td>
                </tr>
                <tr>
                <td>API Gateway</td>
                <td>Single entry for all services</td>
                </tr>
                <tr>
                <td>Observability</td>
                <td>Metrics, logs, tracing</td>
                </tr>
                <tr>
                <td>Multi-layer Caching</td>
                <td>Memory + Redis + CDN</td>
                </tr>
                <tr>
                <td>Advanced Security</td>
                <td>Zero Trust, RBAC, encryption</td>
                </tr>
                <tr>
                <td>Multi-Tenancy</td>
                <td>Multiple clients in one system</td>
                </tr>
                <tr>
                <td>Serverless</td>
                <td>Deploy lightweight Lambda apps</td>
                </tr>
                <tr>
                <td>DevOps</td>
                <td>CI/CD, Docker, Kubernetes</td>
                </tr>
                <tr>
                <td>Resilience</td>
                <td>Auto recovery and retry</td>
                </tr>
                <tr>
                <td>AI Integration</td>
                <td>Combine NestJS with LLMs</td>
                </tr>
                </tbody>
                </table>
                <hr>
                <h2 id="-interview-tip">🎯 Interview Tip</h2>
                <blockquote>
                <p>💬 “At the architectural level, I use NestJS to build modular, multi-tenant microservices with CQRS, distributed caching, and observability via OpenTelemetry.
                I also integrate CI/CD and serverless deployments for scalable production systems.”</p>
                </blockquote>
                <hr>
                <p>هل ترغب أن أضيف لك <strong>Level 6 roadmap (رسم توضيحي بصري)</strong> يوضح الترابط بين هذه المفاهيم؟
                يمكنني توليده كـ <strong>صورة واحدة منظمة</strong> تساعدك في المراجعة قبل المقابلات.</p>

                
                
<p>إليك <strong>Level 7: Advanced Integrations &amp; Ecosystem</strong> في خطة تعلم NestJS — مكتوب بصيغة <strong>Markdown</strong> ✨</p>
<hr>
<h1 id="-level-7-advanced-integrations-ecosystem">🧩 Level 7: Advanced Integrations &amp; Ecosystem</h1>
<p>في هذا المستوى، ستتعلم كيف تدمج NestJS مع أدوات وخدمات خارجية لتبني تطبيقات حقيقية على مستوى الإنتاج.</p>
<hr>
<h2 id="1-database-integration-advanced-">1. Database Integration (Advanced)</h2>
<h3 id="-typeorm-mongoose-deep-dive">🔹 TypeORM &amp; Mongoose Deep Dive</h3>
<ul>
<li>إعداد العلاقات (Relations): OneToOne, OneToMany, ManyToMany</li>
<li>استخدام <strong>QueryBuilder</strong> لكتابة استعلامات مخصصة</li>
<li>التعامل مع الـ <strong>Transactions</strong></li>
<li>تطبيق <strong>Soft Deletes</strong> و <strong>Pagination</strong></li>
</ul>
<h3 id="-prisma-integration">🔹 Prisma Integration</h3>
<ul>
<li>استخدام Prisma ORM كمحرك حديث وقوي</li>
<li>كتابة الـ Schema واستخدام CLI لتوليد Models</li>
<li>التعامل مع العلاقات والمخرجات المخصصة</li>
<li>تنفيذ الـ CRUD Operations</li>
</ul>
<hr>
<h2 id="2-authentication-authorization">2. Authentication &amp; Authorization</h2>
<h3 id="-jwt-authentication">🔹 JWT Authentication</h3>
<ul>
<li>إنشاء Tokens باستخدام <code>@nestjs/jwt</code></li>
<li>استخدام <strong>Guards</strong> للتحقق من المستخدم</li>
<li>تخزين Tokens بأمان (Cookies vs Headers)</li>
</ul>
<h3 id="-role-based-access-control-rbac-">🔹 Role-based Access Control (RBAC)</h3>
<ul>
<li>إنشاء Decorator مخصص مثل <code>@Roles(&#39;admin&#39;)</code></li>
<li>استخدام <strong>Guards</strong> للتحقق من الصلاحيات</li>
</ul>
<h3 id="-oauth2-social-login">🔹 OAuth2 / Social Login</h3>
<ul>
<li>تسجيل الدخول عبر Google, GitHub, Facebook</li>
<li>استخدام مكتبة <code>passport</code> مع NestJS</li>
</ul>
<hr>
<h2 id="3-file-uploads-storage">3. File Uploads &amp; Storage</h2>
<ul>
<li>التعامل مع رفع الملفات باستخدام <code>@nestjs/platform-express</code> وMulter</li>
<li>تخزين الملفات محلياً أو على خدمات مثل AWS S3</li>
<li>إنشاء خدمة FileService لتنظيم الكود</li>
<li>التحقق من نوع الملف وحجمه</li>
</ul>
<hr>
<h2 id="4-mailing-notifications">4. Mailing &amp; Notifications</h2>
<ul>
<li>إرسال الإيميلات باستخدام <code>@nestjs-modules/mailer</code> مع Nodemailer</li>
<li>دعم قوالب HTML للإيميلات</li>
<li>إرسال إشعارات SMS أو Push Notifications عبر خدمات مثل Twilio أو Firebase</li>
</ul>
<hr>
<h2 id="5-task-scheduling-background-jobs">5. Task Scheduling &amp; Background Jobs</h2>
<ul>
<li>استخدام <strong>@nestjs/schedule</strong> لتشغيل المهام الدورية (Cron Jobs)</li>
<li>تنفيذ الـ Background Jobs باستخدام <strong>Bull (Redis Queue)</strong></li>
<li>معالجة العمليات الطويلة في الخلفية (مثل إرسال إيميلات جماعية أو تقارير)</li>
</ul>
<hr>
<h2 id="6-caching-performance">6. Caching &amp; Performance</h2>
<ul>
<li>دمج Redis مع NestJS لتسريع الأداء</li>
<li>استخدام <strong>Cache Interceptor</strong> لتخزين الردود مؤقتًا</li>
<li>إعداد Cache TTL وتحديد مفاتيح التخزين</li>
<li>تحسين الأداء عبر GZIP وCompression Middleware</li>
</ul>
<hr>
<h2 id="7-logging-monitoring">7. Logging &amp; Monitoring</h2>
<ul>
<li>تخصيص Logger في NestJS باستخدام <code>LoggerService</code></li>
<li>تخزين السجلات في ملفات أو قواعد بيانات</li>
<li>دمج أدوات مثل <strong>Winston</strong>, <strong>Pino</strong>, أو <strong>Elastic Stack</strong></li>
<li>مراقبة الصحة (Health Checks) باستخدام <code>@nestjs/terminus</code></li>
</ul>
<hr>
<h2 id="8-api-documentation">8. API Documentation</h2>
<ul>
<li>إنشاء وثائق Swagger تلقائياً عبر <code>@nestjs/swagger</code></li>
<li>إضافة Authentication في الـ Docs</li>
<li>تخصيص عنوان ووصف واجهات الـ API</li>
<li>تصدير الوثائق كملف JSON لاستخدامه خارجياً</li>
</ul>
<hr>
<h2 id="-7">🎯 المهارات بعد المستوى 7</h2>
<p>بعد إنهاء هذا المستوى، ستكون قادراً على:</p>
<ul>
<li>دمج NestJS مع قواعد بيانات متعددة.</li>
<li>تأمين التطبيق باستخدام JWT وGuards.</li>
<li>إدارة الملفات، الإيميلات، والكاش بكفاءة.</li>
<li>إنشاء مهام خلفية وجدولة تلقائية.</li>
<li>توثيق الـ APIs بشكل احترافي.</li>
</ul>
<hr>
<p>هل ترغب أن أقدمه في نسخة <strong>HTML منسقة</strong> (مثل التي استخدمناها في المستويات السابقة) لتضعها في صفحة أو portfolio؟</p>
<p>أكيد ✅
إليك <strong>Level 8: Testing &amp; Quality Assurance</strong> في خطة تعلم NestJS، مكتوب بصيغة <strong>Markdown</strong> ومجهز لسهولة القراءة 👇</p>
<hr>
<h1 id="-level-8-testing-quality-assurance">🧪 Level 8: Testing &amp; Quality Assurance</h1>
<p>في هذا المستوى ستتعلم كيف تختبر تطبيقك في NestJS باحتراف، لضمان الجودة، الثبات، وعدم حدوث مشاكل عند التوسع أو النشر.</p>
<hr>
<h2 id="1-introduction-to-testing-in-nestjs">1. Introduction to Testing in NestJS</h2>
<ul>
<li>فهم أهمية الاختبارات (Unit – Integration – E2E).</li>
<li>NestJS مبني فوق <strong>Jest</strong> كإطار اختبار افتراضي.</li>
<li><p>بنية ملفات الاختبار النموذجية:</p>
<pre><code>src/
 ├── users/
 │     ├── users<span class="hljs-selector-class">.service</span><span class="hljs-selector-class">.spec</span><span class="hljs-selector-class">.ts</span>
 │     ├── users<span class="hljs-selector-class">.controller</span><span class="hljs-selector-class">.spec</span><span class="hljs-selector-class">.ts</span>
 │     └── users<span class="hljs-selector-class">.e2e-spec</span><span class="hljs-selector-class">.ts</span>
</code></pre></li>
</ul>
<hr>
<h2 id="2-unit-testing-">2. Unit Testing (اختبارات الوحدات)</h2>
<ul>
<li>إنشاء اختبارات للوحدات المنفصلة (Services, Pipes, Guards).</li>
<li>استخدام <strong><code>TestingModule</code></strong> من <code>@nestjs/testing</code> لإنشاء نسخة مصغرة من الموديول.</li>
<li>محاكاة (Mocking) الـ Dependencies مثل Repositories وAPIs.</li>
</ul>
<h3 id="-">🔹 مثال:</h3>
<pre><code class="lang-ts">describe('UsersService', () =&gt; {
  let service: UsersService<span class="hljs-comment">;</span>

  beforeEach(<span class="hljs-name">async</span> () =&gt; {
    const module = await Test.createTestingModule({
      providers: [UsersService],
    }).compile()<span class="hljs-comment">;</span>

    service = module.get&lt;UsersService&gt;(<span class="hljs-name">UsersService</span>)<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>

  it('should return all users', () =&gt; {
    expect(<span class="hljs-name">service</span>.findAll()).toEqual(['Ali', 'Sara'])<span class="hljs-comment">;</span>
  })<span class="hljs-comment">;</span>
})<span class="hljs-comment">;</span>
</code></pre>
<hr>
<h2 id="3-integration-testing-">3. Integration Testing (اختبارات التكامل)</h2>
<ul>
<li>اختبار التفاعل بين الوحدات المختلفة (Controller + Service + DB).</li>
<li>إعداد <strong>In-memory database</strong> مثل SQLite أو Mongo Memory Server.</li>
<li>استخدام <code>supertest</code> لإرسال طلبات HTTP داخل بيئة اختبارية.</li>
</ul>
<h3 id="-">🔹 مثال:</h3>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> * <span class="hljs-keyword">as</span> request <span class="hljs-keyword">from</span> <span class="hljs-string">'supertest'</span>;
<span class="hljs-keyword">import</span> { Test } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/testing'</span>;
<span class="hljs-keyword">import</span> { AppModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'../src/app.module'</span>;
<span class="hljs-keyword">import</span> { INestApplication } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;

describe(<span class="hljs-string">'Users (e2e)'</span>, () =&gt; {
  <span class="hljs-keyword">let</span> app: INestApplication;

  beforeAll(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">const</span> <span class="hljs-built_in">module</span> = <span class="hljs-keyword">await</span> Test.createTestingModule({
      <span class="hljs-attr">imports</span>: [AppModule],
    }).compile();

    app = <span class="hljs-built_in">module</span>.createNestApplication();
    <span class="hljs-keyword">await</span> app.init();
  });

  it(<span class="hljs-string">'/users (GET)'</span>, () =&gt; {
    <span class="hljs-keyword">return</span> request(app.getHttpServer())
      .get(<span class="hljs-string">'/users'</span>)
      .expect(<span class="hljs-number">200</span>)
      .expect([<span class="hljs-string">'Ali'</span>, <span class="hljs-string">'Sara'</span>]);
  });

  afterAll(<span class="hljs-keyword">async</span> () =&gt; {
    <span class="hljs-keyword">await</span> app.close();
  });
});
</code></pre>
<hr>
<h2 id="4-e2e-testing-">4. E2E Testing (اختبار من النهاية للنهاية)</h2>
<ul>
<li>محاكاة تجربة المستخدم من البداية للنهاية (مثل تسجيل الدخول ثم الوصول إلى موارد).</li>
<li>اختبار تدفق التطبيق بالكامل.</li>
<li>يستخدم عادةً مع CI/CD pipelines قبل النشر.</li>
</ul>
<hr>
<h2 id="5-mocking-spying-techniques">5. Mocking &amp; Spying Techniques</h2>
<ul>
<li>استخدام <code>jest.fn()</code> لإنشاء دوال وهمية.</li>
<li>مراقبة استدعاءات الدوال باستخدام <code>jest.spyOn()</code>.</li>
<li>التأكد من أن التوابع تعمل كما هو متوقع دون تنفيذ فعلي.</li>
</ul>
<hr>
<h2 id="6-test-coverage-reports">6. Test Coverage &amp; Reports</h2>
<ul>
<li><p>تشغيل التقارير بالأمر:</p>
<pre><code class="lang-bash">npm <span class="hljs-keyword">run</span><span class="bash"> <span class="hljs-built_in">test</span>:cov</span>
</code></pre>
</li>
<li><p>يعرض النسب التالية:</p>
<ul>
<li><strong>Statements</strong></li>
<li><strong>Branches</strong></li>
<li><strong>Functions</strong></li>
<li><strong>Lines</strong></li>
</ul>
</li>
<li>الهدف: الوصول إلى 80%+ تغطية على الأقل في المشاريع الإنتاجية.</li>
</ul>
<hr>
<h2 id="7-ci-cd-integration">7. CI/CD Integration</h2>
<ul>
<li>تشغيل الاختبارات تلقائيًا في GitHub Actions أو GitLab CI قبل النشر.</li>
<li>فشل أي اختبار يمنع عملية الـ deploy.</li>
<li>توليد تقارير تلقائية للتغطية والتحليل.</li>
</ul>
<hr>
<h2 id="8-linting-static-analysis">8. Linting &amp; Static Analysis</h2>
<ul>
<li>استخدام ESLint لفحص جودة الكود.</li>
<li>دمج <strong>Prettier</strong> لتوحيد تنسيق الأكواد.</li>
<li><p>أوامر مهمة:</p>
<pre><code class="lang-bash">npm <span class="hljs-keyword">run</span><span class="bash"> lint
</span>npm <span class="hljs-keyword">run</span><span class="bash"> format</span>
</code></pre>
</li>
</ul>
<hr>
<h2 id="-8">🎯 المهارات بعد المستوى 8</h2>
<p>بعد هذا المستوى، ستكون قادرًا على:</p>
<ul>
<li>كتابة اختبارات وحدات وتكامل كاملة لتطبيقك.</li>
<li>ضبط بيئة اختبار آلية CI/CD.</li>
<li>قياس التغطية وتحسين جودة الكود.</li>
<li>ضمان استقرار التطبيق في بيئات الإنتاج.</li>
</ul>
<hr>
<p>هل ترغب أن أرسل <strong>Level 9 (Deployment &amp; Production Readiness)</strong> بصيغة Markdown أيضًا؟
هو المستوى الذي يشرح كيف تنشر تطبيق NestJS على VPS أو Docker مع إعداد الأمن والأداء.</p>
<p>تمام ✅
إليك <strong>Level 9: Deployment &amp; Production Readiness</strong> مكتوبًا بصيغة <strong>Markdown</strong> منظمة وواضحة 👇</p>
<hr>
<h1 id="-level-9-deployment-production-readiness">🚀 Level 9: Deployment &amp; Production Readiness</h1>
<p>في هذا المستوى ستتعلم كيفية تجهيز مشروع NestJS للنشر على بيئات الإنتاج (Production) — سواء على VPS، Docker، أو خدمات مثل AWS وRender وRailway — مع ضبط الأداء والأمان.</p>
<hr>
<h2 id="1-preparing-the-app-for-production">1. Preparing the App for Production</h2>
<h3 id="-environment-variables">🔹 Environment Variables</h3>
<ul>
<li><p>تخزين الإعدادات الحساسة في ملف <code>.env</code></p>
</li>
<li><p>استخدام <code>ConfigModule</code> لإدارتها:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> { ConfigModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/config'</span>;

@Module({
  imports: [ConfigModule.forRoot({ isGlobal: <span class="hljs-literal">true</span> })],
})
<span class="hljs-keyword">export</span> <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AppModule</span> {}</span>
</code></pre>
</li>
<li><p>تحميل القيم باستخدام:</p>
<pre><code class="lang-ts"><span class="hljs-selector-tag">process</span><span class="hljs-selector-class">.env</span><span class="hljs-selector-class">.DATABASE_URL</span>;
</code></pre>
</li>
</ul>
<h3 id="-build-command">🔹 Build Command</h3>
<ul>
<li><p>توليد نسخة جاهزة للإنتاج:</p>
<pre><code class="lang-bash">npm run build
<span class="hljs-keyword">node</span> <span class="hljs-title">dist</span>/main.js
</code></pre>
</li>
</ul>
<hr>
<h2 id="2-logging-error-handling">2. Logging &amp; Error Handling</h2>
<ul>
<li><p>تفعيل <strong>LoggerService</strong> لتتبع الأحداث:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> { Logger } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/common'</span>;
<span class="hljs-keyword">const</span> logger = <span class="hljs-keyword">new</span> Logger(<span class="hljs-string">'AppBootstrap'</span>);
logger.log(<span class="hljs-string">'Application started!'</span>);
</code></pre>
</li>
<li><p>استخدام <strong>Global Exception Filter</strong>:</p>
<pre><code class="lang-ts">import { <span class="hljs-keyword">Catch</span>, ExceptionFilter, ArgumentsHost, HttpException } from <span class="hljs-string">'@nestjs/common'</span>;

@<span class="hljs-keyword">Catch</span>(HttpException)
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">GlobalExceptionFilter</span> <span class="hljs-keyword">implements</span> <span class="hljs-title">ExceptionFilter</span> </span>{
  <span class="hljs-keyword">catch</span>(<span class="hljs-keyword">exception</span>: HttpException, host: ArgumentsHost) {
    <span class="hljs-keyword">const</span> response = host.switchToHttp().getResponse();
    response
      .status(<span class="hljs-keyword">exception</span>.getStatus())
      .json({ message: <span class="hljs-keyword">exception</span>.message });
  }
}
</code></pre>
</li>
</ul>
<hr>
<h2 id="3-security-hardening">3. Security &amp; Hardening</h2>
<ul>
<li><p>تفعيل <strong>Helmet</strong> لحماية الـ HTTP Headers:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> helmet <span class="hljs-keyword">from</span> <span class="hljs-string">'helmet'</span>;
app.use(helmet());
</code></pre>
</li>
<li><p>تفعيل <strong>CORS</strong> بشكل آمن:</p>
<pre><code class="lang-ts"><span class="hljs-selector-tag">app</span><span class="hljs-selector-class">.enableCors</span>({
  <span class="hljs-attribute">origin</span>: [<span class="hljs-string">'https://yourfrontend.com'</span>],
  methods: [<span class="hljs-string">'GET'</span>, <span class="hljs-string">'POST'</span>],
});
</code></pre>
</li>
<li><p>الحد من عدد الطلبات عبر <strong>Rate Limiting</strong>:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">npm</span> install @nestjs/throttler
</code></pre>
<pre><code class="lang-ts"><span class="hljs-variable">@UseGuards</span>(ThrottlerGuard)
<span class="hljs-variable">@Throttle</span>(<span class="hljs-number">10</span>, <span class="hljs-number">60</span>) <span class="hljs-comment">// 10 requests per 60 seconds</span>
</code></pre>
</li>
<li><p>إخفاء تفاصيل الأخطاء في الإنتاج:</p>
<pre><code class="lang-bash"><span class="hljs-attr">NODE_ENV</span>=production
</code></pre>
</li>
</ul>
<hr>
<h2 id="4-performance-optimization">4. Performance Optimization</h2>
<ul>
<li><p>تفعيل <strong>Compression</strong>:</p>
<pre><code class="lang-ts"><span class="hljs-keyword">import</span> compression <span class="hljs-keyword">from</span> <span class="hljs-string">'compression'</span>;
app.use(compression());
</code></pre>
</li>
<li><p>استخدام <strong>Caching</strong> مع Redis:</p>
<pre><code class="lang-ts"><span class="hljs-selector-tag">CacheModule</span><span class="hljs-selector-class">.register</span>({
  <span class="hljs-attribute">store</span>: redisStore,
  host: <span class="hljs-string">'localhost'</span>,
  port: <span class="hljs-number">6379</span>,
});
</code></pre>
</li>
<li><p>تحميل Lazy Modules فقط عند الحاجة لتقليل استهلاك الذاكرة.</p>
</li>
</ul>
<hr>
<h2 id="5-deployment-options">5. Deployment Options</h2>
<h3 id="-using-docker">🔹 Using Docker</h3>
<ol>
<li><p>إنشاء ملف <code>Dockerfile</code>:</p>
<pre><code class="lang-Dockerfile"><span class="hljs-keyword">FROM</span> node:<span class="hljs-number">20</span>
<span class="hljs-keyword">WORKDIR</span><span class="bash"> /app
</span><span class="hljs-keyword">COPY</span><span class="bash"> package*.json ./
</span><span class="hljs-keyword">RUN</span><span class="bash"> npm install --production
</span><span class="hljs-keyword">COPY</span><span class="bash"> . .
</span><span class="hljs-keyword">RUN</span><span class="bash"> npm run build
</span><span class="hljs-keyword">CMD</span><span class="bash"> [<span class="hljs-string">"node"</span>, <span class="hljs-string">"dist/main.js"</span>]</span>
</code></pre>
</li>
<li><p>بناء الصورة وتشغيلها:</p>
<pre><code class="lang-bash">docker build -t nest-<span class="hljs-keyword">app</span> .
docker <span class="hljs-keyword">run</span> -p 3000:3000 nest-<span class="hljs-keyword">app</span>
</code></pre>
</li>
</ol>
<hr>
<h3 id="-deploying-to-vps-ubuntu-server-">🔹 Deploying to VPS (مثل Ubuntu Server)</h3>
<ol>
<li>رفع المشروع باستخدام <code>git clone</code>.</li>
<li><p>تثبيت Node.js وPM2:</p>
<pre><code class="lang-bash">npm <span class="hljs-keyword">install</span> -g pm2
</code></pre>
</li>
<li><p>تشغيل التطبيق:</p>
<pre><code class="lang-bash">pm2 <span class="hljs-keyword">start</span> dist/main.js <span class="hljs-comment">--name nest-api</span>
pm2 <span class="hljs-keyword">startup</span>
pm2 <span class="hljs-keyword">save</span>
</code></pre>
</li>
<li><p>إعداد Nginx لعكس الطلبات (reverse proxy):</p>
<pre><code class="lang-nginx"><span class="hljs-section">server</span> {
    <span class="hljs-attribute">listen</span> <span class="hljs-number">80</span>;
    <span class="hljs-attribute">server_name</span> api.yourdomain.com;
    <span class="hljs-attribute">location</span> / {
        <span class="hljs-attribute">proxy_pass</span> http://127.0.0.1:3000;
    }
}
</code></pre>
</li>
</ol>
<hr>
<h3 id="-deploying-to-cloud-platforms">🔹 Deploying to Cloud Platforms</h3>
<ul>
<li><p><strong>Render / Railway / Vercel / AWS ECS</strong></p>
<ul>
<li>اربط الريبو على GitHub.</li>
<li><p>أضف أوامر:</p>
<pre><code class="lang-bash">npm run build &amp;&amp; <span class="hljs-keyword">node</span> <span class="hljs-title">dist</span>/main.js
</code></pre>
</li>
<li>أضف متغيرات البيئة داخل لوحة التحكم.</li>
</ul>
</li>
</ul>
<hr>
<h2 id="6-monitoring-health-checks">6. Monitoring &amp; Health Checks</h2>
<ul>
<li><p>استخدام <code>@nestjs/terminus</code>:</p>
<pre><code class="lang-bash"><span class="hljs-built_in">npm</span> install @nestjs/terminus
</code></pre>
<pre><code class="lang-ts"><span class="hljs-meta">@Get(<span class="hljs-meta-string">'health'</span>)</span>
<span class="hljs-meta">@HealthCheck()</span>
check() {
  <span class="hljs-keyword">return</span> <span class="hljs-keyword">this</span>.health.check([
    () =&gt; <span class="hljs-keyword">this</span>.db.pingCheck(<span class="hljs-string">'database'</span>),
    () =&gt; <span class="hljs-keyword">this</span>.http.pingCheck(<span class="hljs-string">'google'</span>, <span class="hljs-string">'https://google.com'</span>),
  ]);
}
</code></pre>
</li>
<li><p>دمج أدوات مثل <strong>Prometheus</strong>, <strong>Grafana</strong>, أو <strong>Sentry</strong> لتتبع الأخطاء.</p>
</li>
</ul>
<hr>
<h2 id="7-versioning-documentation">7. Versioning &amp; Documentation</h2>
<ul>
<li><p>تفعيل <strong>API Versioning</strong>:</p>
<pre><code class="lang-ts">app.enableVersioning({
  type: VersioningType.URI,
});
<span class="hljs-regexp">//</span> <span class="hljs-regexp">/v1/u</span>sers , <span class="hljs-regexp">/v2/u</span>sers
</code></pre>
</li>
<li><p>تحديث Swagger docs عند كل إصدار:</p>
<pre><code class="lang-bash">/api/<span class="hljs-built_in">v1</span>/docs
</code></pre>
</li>
</ul>
<hr>
<h2 id="8-backup-disaster-recovery">8. Backup &amp; Disaster Recovery</h2>
<ul>
<li>نسخ احتياطي لقاعدة البيانات بشكل دوري.</li>
<li>استخدام أدوات مثل <code>pg_dump</code>, <code>mongodump</code>, أو <code>AWS Backup</code>.</li>
<li>مراقبة الأخطاء وإرسال تنبيهات فورية عبر Slack أو Email.</li>
</ul>
<hr>
<h2 id="-9">🎯 المهارات بعد المستوى 9</h2>
<p>بعد إنهاء هذا المستوى ستكون قادراً على:</p>
<ul>
<li>نشر تطبيق NestJS على أي بيئة إنتاجية.</li>
<li>تأمينه ضد الهجمات الشائعة.</li>
<li>مراقبته وتتبّع أدائه بشكل احترافي.</li>
<li>إدارة النسخ الاحتياطية والتعافي من الأعطال.</li>
</ul>
<hr>
<p>هل ترغب أن أرسل <strong>Level 10 (Scaling &amp; Microservices Architecture)</strong> التالي؟
هو آخر مستوى في الخطة ويتناول بناء الأنظمة الكبيرة باستخدام NestJS Microservices وEvent-driven design.</p>
<p>رائع 👌
إليك <strong>Level 10: Scaling &amp; Microservices Architecture</strong> مكتوبًا بصيغة <strong>Markdown</strong> احترافية — هذا هو المستوى الأخير في خطة إتقان NestJS.</p>
<hr>
<h1 id="-level-10-scaling-microservices-architecture">🏗️ Level 10: Scaling &amp; Microservices Architecture</h1>
<p>في هذا المستوى ستتعلم كيف تصمم وتبني أنظمة <strong>قابلة للتوسع (Scalable)</strong> باستخدام <strong>Microservices</strong> و<strong>Event-driven architecture</strong> في NestJS.
هذا المستوى هو ما يميز مهندس Backend محترف يعمل على تطبيقات Enterprise ضخمة.</p>
<hr>
<h2 id="1-understanding-microservices-in-nestjs">1. Understanding Microservices in NestJS</h2>
<h3 id="-">🔹 ما هي الميكروسيرفيس؟</h3>
<ul>
<li>هي طريقة لتقسيم النظام إلى <strong>خدمات صغيرة مستقلة</strong>، كل خدمة تؤدي وظيفة محددة (مثل auth، payments، notifications...).</li>
<li>كل خدمة تمتلك <strong>قاعدة بياناتها الخاصة</strong> وتتواصل مع الخدمات الأخرى عبر <strong>رسائل (Messages)</strong> بدلاً من الاستدعاءات المباشرة.</li>
</ul>
<h3 id="-">🔹 لماذا نستخدمها؟</h3>
<ul>
<li>تسهيل التطوير والصيانة.</li>
<li>توزيع الحمل على سيرفرات متعددة.</li>
<li>النشر المستقل لكل خدمة.</li>
<li>المرونة في اختيار التقنيات (Polyglot).</li>
</ul>
<hr>
<h2 id="2-nestjs-microservices-basics">2. NestJS Microservices Basics</h2>
<p>NestJS يدعم نمط الميكروسيرفيس من خلال <strong>Transport Layer</strong> (طبقة النقل).</p>
<h3 id="-">أنواع النقل المدعومة:</h3>
<ul>
<li><strong>TCP</strong> (الافتراضي)</li>
<li><strong>Redis</strong></li>
<li><strong>NATS</strong></li>
<li><strong>MQTT</strong></li>
<li><strong>Kafka</strong></li>
<li><strong>RabbitMQ</strong></li>
<li><strong>gRPC</strong></li>
</ul>
<hr>
<h2 id="3-creating-a-microservice">3. Creating a Microservice</h2>
<h3 id="-">📦 مثال:</h3>
<h4 id="-authentication">🧩 خدمة Authentication</h4>
<pre><code class="lang-ts"><span class="hljs-comment">// main.ts</span>
<span class="hljs-keyword">import</span> { NestFactory } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/core'</span>;
<span class="hljs-keyword">import</span> { AppModule } <span class="hljs-keyword">from</span> <span class="hljs-string">'./app.module'</span>;
<span class="hljs-keyword">import</span> { MicroserviceOptions, Transport } <span class="hljs-keyword">from</span> <span class="hljs-string">'@nestjs/microservices'</span>;

<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">bootstrap</span>(<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> app = <span class="hljs-keyword">await</span> NestFactory.createMicroservice&lt;MicroserviceOptions&gt;(AppModule, {
    <span class="hljs-attr">transport</span>: Transport.TCP,
    <span class="hljs-attr">options</span>: { <span class="hljs-attr">host</span>: <span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-attr">port</span>: <span class="hljs-number">8877</span> },
  });
  <span class="hljs-keyword">await</span> app.listen();
}
bootstrap();
</code></pre>
<h4 id="-listener-subscriber-">🎧 Listener (Subscriber)</h4>
<pre><code class="lang-ts"><span class="hljs-meta">@Controller()</span>
export <span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">AuthController</span> </span>{
  <span class="hljs-meta">@MessagePattern({ cmd: <span class="hljs-meta-string">'login'</span> })</span>
  login(<span class="hljs-keyword">data</span>: any) {
    <span class="hljs-keyword">return</span> { success: <span class="hljs-literal">true</span>, user: <span class="hljs-keyword">data</span>.username };
  }
}
</code></pre>
<hr>
<h2 id="4-communicating-between-services">4. Communicating Between Services</h2>
<h3 id="-client-">📡 من خدمة أخرى (Client):</h3>
<pre><code class="lang-ts">const client = ClientProxyFactory.create({
<span class="hljs-symbol">  transport:</span> Transport.TCP,
<span class="hljs-symbol">  options:</span> { <span class="hljs-string">host:</span> <span class="hljs-string">'127.0.0.1'</span>, <span class="hljs-string">port:</span> <span class="hljs-number">8877</span> },
});

client.send({ <span class="hljs-string">cmd:</span> <span class="hljs-string">'login'</span> }, { <span class="hljs-string">username:</span> <span class="hljs-string">'Ali'</span> }).subscribe(console.log);
</code></pre>
<ul>
<li><code>send()</code> → لطلب ينتظر رد.</li>
<li><code>emit()</code> → لبث رسالة بدون انتظار رد (Event-driven).</li>
</ul>
<hr>
<h2 id="5-event-driven-architecture">5. Event-Driven Architecture</h2>
<h3 id="-">🔹 الفكرة</h3>
<p>بدلاً من استدعاء الخدمات مباشرة، يتم تبادل الأحداث:</p>
<blockquote>
<p>عند تسجيل مستخدم جديد → يتم نشر حدث &quot;user_created&quot;
خدمة الإشعارات تلتقط الحدث وتُرسل رسالة ترحيب.</p>
</blockquote>
<h3 id="-">🔹 الفائدة</h3>
<ul>
<li>تقليل التداخل بين الخدمات.</li>
<li>جعل النظام أكثر مرونة واستقلالية.</li>
</ul>
<h3 id="-">🔹 مثال:</h3>
<pre><code class="lang-ts"><span class="hljs-comment">// users.service.ts</span>
<span class="hljs-built_in">this</span>.client.emit(<span class="hljs-string">'user_created'</span>, <span class="hljs-keyword">new</span><span class="hljs-type">User</span>);
</code></pre>
<pre><code class="lang-ts"><span class="hljs-comment">// notifications.service.ts</span>
<span class="hljs-meta">@EventPattern(<span class="hljs-meta-string">'user_created'</span>)</span>
handleUserCreated(<span class="hljs-keyword">data</span>) {
  console.log(<span class="hljs-string">'Welcome email sent to:'</span>, <span class="hljs-keyword">data</span>.email);
}
</code></pre>
<hr>
<h2 id="6-scaling-services">6. Scaling Services</h2>
<h3 id="-horizontal-scaling">🧭 Horizontal Scaling</h3>
<ul>
<li>تشغيل عدة نسخ من نفس الميكروسيرفيس خلف <strong>Load Balancer</strong> (مثل Nginx أو Kubernetes).</li>
<li>Redis أو Kafka تساعد في توزيع الرسائل بالتساوي بين النسخ.</li>
</ul>
<h3 id="-">🧰 أدوات مفيدة</h3>
<ul>
<li><strong>PM2 Cluster Mode</strong></li>
<li><strong>Docker Compose</strong> لتشغيل عدة خدمات معًا</li>
<li><strong>Kubernetes</strong> للتوسع التلقائي (Auto-scaling)</li>
</ul>
<hr>
<h2 id="7-api-gateway">7. API Gateway</h2>
<h3 id="-">🔹 دوره</h3>
<ul>
<li>نقطة دخول موحدة لكل الخدمات.</li>
<li>يتعامل مع المصادقة، الـ rate limiting، الـ caching.</li>
<li>يوجه الطلب إلى الخدمة الصحيحة.</li>
</ul>
<h3 id="-nestjs-">🔹 يمكن بناؤه باستخدام NestJS أيضًا:</h3>
<pre><code class="lang-bash"><span class="hljs-attribute">nest g app api-gateway</span>
</code></pre>
<h3 id="-">🔹 أو استخدام أدوات خارجية مثل:</h3>
<ul>
<li><strong>Kong</strong></li>
<li><strong>NGINX</strong></li>
<li><strong>Express Gateway</strong></li>
</ul>
<hr>
<h2 id="8-distributed-configuration-secrets">8. Distributed Configuration &amp; Secrets</h2>
<ul>
<li>استخدام <strong>Consul</strong> أو <strong>Vault</strong> أو <strong>AWS Parameter Store</strong> لإدارة الإعدادات عبر الخدمات.</li>
<li>كل خدمة تقرأ متغيراتها الخاصة عند الإقلاع.</li>
</ul>
<hr>
<h2 id="9-observability-">9. Observability (المراقبة والتحليل)</h2>
<ul>
<li>دمج <strong>OpenTelemetry</strong> لمراقبة الأداء وتتبع الطلبات عبر الخدمات.</li>
<li>تسجيل الأحداث والطلبات في <strong>ELK Stack (Elasticsearch + Logstash + Kibana)</strong> أو <strong>Grafana Loki</strong>.</li>
<li>استخدام <strong>Jaeger</strong> لتتبع الطلبات الموزعة.</li>
</ul>
<hr>
<h2 id="10-deployment-in-microservice-environment">10. Deployment in Microservice Environment</h2>
<h3 id="-docker-compose">🔹 باستخدام Docker Compose</h3>
<pre><code class="lang-yaml"><span class="hljs-attribute">version</span>: <span class="hljs-string">'3'</span>
<span class="hljs-attribute">services</span>:
  <span class="hljs-attribute">auth-service</span>:
    <span class="hljs-attribute">build</span>: ./auth
    <span class="hljs-attribute">ports</span>:
      - <span class="hljs-string">"3001:3000"</span>
  <span class="hljs-attribute">users-service</span>:
    <span class="hljs-attribute">build</span>: ./users
    <span class="hljs-attribute">ports</span>:
      - <span class="hljs-string">"3002:3000"</span>
  <span class="hljs-attribute">api-gateway</span>:
    <span class="hljs-attribute">build</span>: ./gateway
    <span class="hljs-attribute">ports</span>:
      - <span class="hljs-string">"3000:3000"</span>
</code></pre>
<h3 id="-kubernetes">🔹 أو باستخدام Kubernetes</h3>
<ul>
<li>تعريف كل خدمة كـ Deployment + Service.</li>
<li>إعداد autoscaling وhealth checks.</li>
<li>استخدام Ingress Controller لتوجيه الطلبات.</li>
</ul>
<hr>
<h2 id="-10">🎯 المهارات بعد المستوى 10</h2>
<p>بعد هذا المستوى ستكون قادرًا على:</p>
<ul>
<li>تصميم وبناء أنظمة Microservices كاملة باستخدام NestJS.</li>
<li>إدارة الاتصال بين الخدمات عبر TCP, Redis, Kafka, أو RabbitMQ.</li>
<li>تنفيذ Event-driven communication بشكل احترافي.</li>
<li>نشر الخدمات في بيئة موزعة قابلة للتوسع.</li>
<li>مراقبة وتحليل أداء النظام بشكل مركزي.</li>
</ul>
<hr>
<p>هل ترغب أن أرسل لك <strong>ملف PDF أو Markdown كامل</strong> يحتوي على المستويات العشرة جميعها بشكل منسق كمرجع شامل لتعلم NestJS؟</p>
                
                      
</body>
</html>